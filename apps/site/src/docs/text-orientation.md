````md
---
title: 文字の向き（Text Orientation）
description: 3D空間で2D文字を扱うときに生じる「上下・表裏・行方向」の問題と、3DSLでの整理方針
status: draft
order: 20
tags: [text, typography, rendering, layout]
---

# 文字の向き（Text Orientation）

## このページの目的

3DSL は 3D 空間上に図形だけでなく「文字」を配置し、拡大縮小・視点移動の中でも読める状態を保つことを目指します。  
ところが、文字は本来 2D の記号であり、紙や画面の上では暗黙に固定されていた前提（上下・表裏・行の流れ）が、3D 空間では簡単に崩れます。

このページでは、次を整理します。

- これまで（2D）暗黙に済んでいた「文字の向き」の前提
- 3D に拡張すると何が増えるのか（どこで破綻するのか）
- 実装上の代表的な手法と、典型的な落とし穴
- 3DSL として、なぜ向きを明示するのか（どう分解して表現するのか）

## なぜ「文字の向き」は問題になるのか

紙の上の文字は、通常「正面から」「表面を」「上が上になるように」読むものです。  
しかし 3D では次が同時に発生します。

- 文字が置かれた面に対して、カメラがどの方向からでも近づける
- 面の裏側に回り込める（表裏が入れ替わる）
- 回転によって上下が反転し得る
- 縦書き／横書き、行方向、字形の向きが分離して問題化する

つまり、2D で「当然」とされていた読みの前提が、3D では当然ではなくなります。  
ここを曖昧にすると「同じデータなのに、環境や実装により読めたり読めなかったりする」状態が生まれます。

3DSL はこれを避けるため、**暗黙の前提のうち“意味が崩れる部分”だけを、最小限データとして明示する**方針を取ります。

## 2D の基本：天地 × 裏表 = 4 パターン

単純化して、紙のような 1 枚の 2D 面に文字を書く場面を考えます。  
文字の向きは多くの場合、次の 2 軸で語れます。

- **天地（上下）**：正立／180°回転（上下逆）
- **裏表**：表面／裏面

これで 2×2 = 4 パターンになります。

ただし「裏面」の扱いには注意が必要です。  
単に平面に片面の文字を貼り付けただけの場合、裏側から見ると **鏡文字（ミラー）** になり、通常は読めません。  
逆に、裏面にも読むための文字が存在する（両面印刷）場合は、裏面側の文字は「別の配置・別の向き」として扱うべきです。

## 3D に拡張すると増えるもの：面（plane）と基準軸（basis）

3D の姿勢は連続的な回転ですが、文字に関しては次の 3 要素に分解すると整理しやすくなります。

1. **面（plane）**：文字が載る面（あるいはカメラ追従）
2. **表（front）**：どちらが「印字面」か（法線方向）
3. **上（up）**：文字にとっての“上”はどちらか

言い換えると、文字のローカル座標として

- 右（right）
- 上（up）
- 表（normal / front）

の基底（basis）を決める話です。  
基底が決まると、整列（左/中央/右）やベースライン（上/中央/下）などの 2D レイアウトを、面上に素直に適用できます。

## 縦書き・横書き：行の流れと字形の向きは別問題

縦書きを「90°回転した横書き」と見なすと、多くの場合で違和感が出ます。  
縦書きには少なくとも 2 層あります。

- **行（ライン／ブロック）の流れ**：縦に積むのか、横に流すのか
- **字形（グリフ）の向き**：各文字を立てる／寝かす／置換する

たとえば縦書きでは、漢字・かなは基本的に立ったままですが、ラテン文字や数字は文脈により寝かせることがあります。  
さらに、句読点や括弧などは縦書き用の字形に置換されることがあります。

3D で文字を表現する場合も、次を分離して扱うと設計が安定します。

- **writing mode（書字方向）**：行と段の流れ
- **glyph policy（字形方針）**：縦組みにおける字形の扱い（自動／固定／言語依存）

## 表裏と可読性：裏面は「同じ文字を読む」場面ではない

3D では裏側に回り込めますが、次のどちらを目指すかは最初に決める必要があります。

- **表面のみ可読**：裏からは読めなくてよい（鏡文字でもよい／非表示でもよい）
- **両面で可読**：裏側からも読める必要がある（別の文字を配置する／両面用に複製する）

3DSL の観点では「両面で可読」は単なる描画設定ではなく、**情報設計の問題**です。  
裏面で読ませたいなら、それは別の配置ルール（別の front/up）を持つ別要素として扱う方が、データの意図が明確になります。

## 実装上の代表的な手法（現状）

3D 空間で文字を描く代表的な手法は次の 3 系統です。

### 1) ビルボード（カメラ追従）
- 常にカメラへ正対させる方式
- 長所：常に読みやすい／小さくても視認性が保ちやすい
- 短所：カメラ回転により上下が反転し得る／“世界に貼られた文字”としての実在感が弱い

「追従しつつ、上方向は固定したい」という要件が出やすく、ここで向きの契約が曖昧だと挙動が破綻します。

### 2) 面に貼る（ワールド固定）
- XY / XZ / YZ など、特定の面（または任意の面）に固定して置く
- 長所：図と一体化しやすい／空間内の情報として安定する
- 短所：角度によって読めなくなる／裏に回ると鏡文字になる

### 3) スクリーン空間（HUD）
- 3D とは独立に、画面上の UI として描く
- 長所：可読性が最大／レイアウトが簡単
- 短所：3D 空間の一部として扱いにくい／奥行きや遮蔽の意味が変わる

3DSL では用途によりこれらを使い分けつつ、特に 1) と 2) の境界を明確にするために「向き」の分解が重要になります。

## 3DSL の設計方針：曖昧な「orientation」を採用しない

一般に “orientation” という語は、3D の回転全般、または他形式での別概念として広く使われます。  
そのため 3DSL では、単独の `orientation` のような曖昧な 1 フィールドに情報を押し込めず、意図が異なる要素を分解して表現する方針を取ります。

分解の基本は次です。

- **配置（placement）**：どの面に、どの基準軸で置くか
- **追従（facing）**：カメラ追従か、ワールド固定か
- **書字方向（writing）**：縦書き／横書き、行の流れ
- **字形方針（glyph）**：縦組み時の字形をどう扱うか
- **可読性ポリシー（visibility）**：裏面を読む必要があるか

この分解により、実装の都合で挙動が変わる部分を“契約”として固定しやすくなります。

## 推奨する最小分解（概念例）

以下は「考え方」の例です。フィールド名は 3DSL の実スキーマに合わせて調整します。

```jsonc
{
  "text": {
    // 1) 配置（面と基準軸）
    "plane": "xy",      // "xy" | "yz" | "zx" | "free" など
    "front": "+z",      // 表面の法線方向
    "up": "+y",         // 文字にとっての上方向

    // 2) 追従
    "facing": "world",  // "world" | "camera" | "camera_y_up" など

    // 3) 書字と字形
    "writing": "horizontal", // "horizontal" | "vertical-rl" など
    "glyph": "auto",          // "auto" | "upright" | "sideways" | "fixed" など

    // 4) 可読性
    "backface": "hidden" // "hidden" | "mirror_ok" | "readable" など
  }
}
````

ここで重要なのは「回転値（連続量）」を先に置くことではなく、**読むために必要な離散的な前提をまず固定する**ことです。
回転値は、自由面（free）や任意姿勢の要件が確定してから導入しても遅くありません。

## 典型パターン（考え方の棚）

運用上よく使うパターンは、先に名前を付けておくと混乱が減ります。

* **ワールド固定・XY 面**：図の平面（地図・キャンバス）に貼る
* **ワールド固定・YZ/Zx 面**：立て札、断面注釈
* **カメラ追従（純ビルボード）**：常に読ませたいラベル
* **カメラ追従（上固定）**：ビルボードだが上下が反転しないよう拘束
* **両面可読**：裏面にも読む意図がある（要素複製が基本）

3DSL では、これらの違いが「見た目」ではなく「契約」になるため、データで判別できる形にしておく価値があります。

## よくある落とし穴

* **裏面を読ませたいのに片面のまま**：鏡文字になり、環境によっては誤読される
* **ビルボードで上下が反転**：カメラ操作の途中で文字が逆さになり、UI として破綻する
* **縦書きを単純回転で済ませる**：句読点や括弧、英数字の扱いが崩れる
* **向き・整列・サイズが混線する**：拡大縮小や距離スケールの調整と、基準軸の決定が混ざる

これらは「回転のバグ」というより、**契約（前提）が未定義**であることから起きます。

## 今後の拡張（検討事項）

* 文字列の一部だけ縦組みルールを変える（例：英数字の扱い）
* ルビ（ruby）や注釈のレイアウト（3DSL の読み物との接続）
* 多言語・多書記体系に対する既定値（データの最小化と表現力の両立）
* 遮蔽・深度テスト・常時前面表示など、「読める」ための表示ポリシー

---

## 用語メモ

* **front / backface**：文字の表面／裏面。裏面の可読性はデータ上の意図として扱う。
* **up**：文字にとっての上。ビルボード時の上下反転を防ぐ鍵になる。
* **writing**：行の流れ（縦書き・横書き）を指す。字形の向きとは別概念。
* **glyph policy**：縦書き時の英数字や記号など、字形の扱い方針。

```
```
