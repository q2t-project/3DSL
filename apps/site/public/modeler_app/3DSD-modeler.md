================================
3DSD-modeler.md â€” 3DSD Modeler
================================

# 0 ç›®çš„ãƒ»é©ç”¨ç¯„å›²

## 0.1 modeler ã®å½¹å‰²

3DSD-modelerï¼ˆä»¥ä¸‹ã€modelerï¼‰ã¯ã€3DSL ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã‘ã‚‹ **æ§‹é€ ãƒ‡ãƒ¼ã‚¿ï¼ˆ.3dss.jsonï¼‰ã®ä½œæˆãƒ»ç·¨é›†ãƒ»æ¤œè¨¼ãƒ»å‡ºåŠ›** ã«ç‰¹åŒ–ã—ãŸå°‚ç”¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚ã‚‹ã€‚

modeler ã¯æ¬¡ã‚’æä¾›ã™ã‚‹ã€‚

- points / lines / aux ã®ä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤
- frameï¼ˆæ™‚é–“å±¤ï¼‰å¯è¦–æ€§ï¼ˆappearance.framesï¼‰ã®ç·¨é›†ã¨å†ç”Ÿãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
- name / caption / appearance / meta ã®ç·¨é›†
- é¸æŠãƒ»è¤‡æ•°é¸æŠãƒ»ä¸€æ‹¬å¤‰å½¢ï¼ˆMove/Rotate/Scaleï¼‰
- æ–‡å­—ï¼ˆmarker.text / caption_text / aux.appearance.module.extension.latexï¼‰ã®å‘ãï¼ˆtext_pose: front/upï¼‰ã‚’å«ã‚€æ­£ç¢ºãªãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
- strict validationï¼ˆã‚¹ã‚­ãƒ¼ãƒæº–æ‹ ï¼‰ã¨ Quick Check
- ãƒ•ã‚¡ã‚¤ãƒ«å…¥å‡ºåŠ›ï¼ˆOpen/Save/Save As/Exportï¼‰
- Preview Outï¼ˆäºŒé¢è¡¨ç¤º/å¤–éƒ¨è¡¨ç¤ºï¼šå¤–éƒ¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¸ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å‡ºåŠ›ï¼‰

### é‡è¦ãªå‰æï¼ˆviewer ã¨ã®å¯¾ç§°æ€§ï¼‰

- modeler ã¯ **write-enabled**ï¼ˆç·¨é›†ãƒ»ä¿å­˜ã‚’è¡Œã†ï¼‰
- viewer ã¯ **read-only**ï¼ˆæ§‹é€ ãƒ‡ãƒ¼ã‚¿ã‚’çµ¶å¯¾ã«å¤‰æ›´ã—ãªã„ï¼‰
- ä¸¡è€…ã¯å¯¾ç§°çš„ãªå½¹å‰²åˆ†æ‹…ã‚’æŒã¤ï¼ˆç”Ÿæˆï¼modelerã€é–²è¦§ï¼viewerï¼‰

## 0.2 common / schema ä»•æ§˜ã¨ã®é–¢ä¿‚ï¼ˆã‚¹ã‚­ãƒ¼ãƒãŒå¥‘ç´„ SSOTï¼‰

modeler ã¯æ¬¡ã®ä¸€æ¬¡è³‡æ–™ï¼ˆå¥‘ç´„ï¼‰ã«å¾“ã†ã€‚

- `/schemas/3DSS.schema.json`ï¼ˆå¥‘ç´„ SSOTï¼‰
- `/specs/3DSD-common.md`ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼šå…±é€šä»•æ§˜ï¼‰

modeler ã® **Export 3DSS** ã¯å¸¸ã«ã‚¹ã‚­ãƒ¼ãƒæº–æ‹ ã§ã‚ã‚‹ã“ã¨ï¼ˆstrictï¼‰ã‚’è¦æ±‚ã™ã‚‹ã€‚
ä¸€æ–¹ã§ **Import / prepï¼ˆèª­è¾¼ï¼‰** ã¯ã€ä¸Šæµã‹ã‚‰æµå…¥ã™ã‚‹å¤šæ§˜ãªå½¢å¼ãƒ»ä¸è¶³ãƒ»ä½™å‰°ã‚’å¸åã™ã‚‹ãŸã‚ã«ã€å¯›å®¹ï¼ˆpermissiveï¼‰ãªå…¥å£ã‚’æŒã£ã¦ã‚ˆã„ã€‚
ãŸã ã—ã€å¯›å®¹ã•ã¯ **å†…éƒ¨ IRï¼ˆä¸­é–“è¡¨ç¾ï¼‰** ã«é–‰ã˜ã€**3DSS å‡ºåŠ›ã«æ±šæŸ“ï¼ˆã‚³ãƒ³ã‚¿ãƒŸï¼‰ã•ã›ãªã„**ã€‚

- ã€Œã‚¹ã‚­ãƒ¼ãƒä¸æ˜ãªã®ã§æ¨æ¸¬ã—ã¦è£œé–“ã—ã€å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿ã«æ··å…¥ã•ã›ã‚‹ã€ã“ã¨ã¯ **ç¦æ­¢**
- ä¸è¶³ï¼ˆrequired æ¬ è½ï¼‰ã‚’è¨±å®¹ã™ã‚‹å ´åˆã§ã‚‚ã€Export æ™‚ç‚¹ã§ã¯å¿…ãšè§£æ¶ˆã—ã€strict validate ã‚’é€šã™ã“ã¨
- ä½™å‰°ï¼ˆunknown fields / comments / markers ç­‰ï¼‰ã‚’ä¿æŒã™ã‚‹å ´åˆã¯ã€3DSS ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæœ¬ä½“ã«æ··å…¥ã•ã›ãšã€IR ã¾ãŸã¯ sidecar ã«éš”é›¢ã™ã‚‹ã“ã¨

## 0.3 é©ç”¨ç¯„å›²

æœ¬ä»•æ§˜ã¯ modeler å®Ÿè£…ï¼ˆä¾‹ï¼š`/apps/modeler/`ï¼‰ã®å…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«é©ç”¨ã™ã‚‹ã€‚

- Coreï¼šç·¨é›†çŠ¶æ…‹ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆçŠ¶æ…‹ãƒ»ã‚³ãƒãƒ³ãƒ‰å±¥æ­´
- Rendererï¼šthree.js æç”»ã€é¸æŠãƒã‚¤ãƒ©ã‚¤ãƒˆ
- UIï¼šãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒŠï¼‰ãƒ»ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ ç·¨é›†
- Validatorï¼šAJV strict validation / Quick Check
- I/Oï¼šFSA ãªã©ãƒ•ã‚¡ã‚¤ãƒ«å…¥å‡ºåŠ›
- Utilsï¼šåº§æ¨™å¤‰æ›ã€poseï¼ˆfront/upï¼‰å‡¦ç†

## 0.4 éå¯¾è±¡ï¼ˆæœ¬ä»•æ§˜ã®ç¯„å›²å¤–ï¼‰

- å³ä¸‹ã®æ–¹ä½ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆï¼ˆã„ã‚ã‚†ã‚‹ gizmoï¼šã‚«ãƒ¡ãƒ©å§¿å‹¢æŒ‡æ¨™ã®åŸºæº–ãƒ¢ãƒ‡ãƒ«ï¼‰


- 3DSS.schema.json è‡ªä½“ã®å®šç¾©ãƒ»å¤‰æ›´
- viewer ã®è‡ªå‹•èµ·å‹•ãƒ»çµ±åˆï¼ˆåˆ¥ã‚¢ãƒ—ãƒªã¨ã™ã‚‹ï¼‰
- å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€è¿½è·¡é€šä¿¡
- ã‚³ãƒ©ãƒœç·¨é›†ï¼ˆåŒæ™‚ç·¨é›†ãƒ»ãƒãƒ¼ã‚¸ï¼‰ â€»å°†æ¥æ‹¡å¼µ
- CAD å®Œå…¨äº’æ›ï¼ˆDWG/DXF äº’æ›ãªã©ï¼‰ â€»æœ¬ä»•æ§˜ã¯ 3DSS ã®ç·¨é›†ã«é™å®š

## 0.5 è¨­è¨ˆæ–¹é‡ï¼ˆç·¨é›†ã‚¢ãƒ—ãƒªã¨ã—ã¦ï¼‰

1. **ã‚¹ã‚­ãƒ¼ãƒå¥‘ç´„ã®å³å®ˆï¼ˆExport ã¯ strictï¼‰**  
   å‡ºåŠ›ã¯å¸¸ã« `3DSS.schema.json` ã« strict æº–æ‹ ã™ã‚‹ã€‚

2. **ç·¨é›†ã®å®‰å…¨æ€§ï¼ˆUndo/Redo ã‚’èƒŒéª¨ã«ã™ã‚‹ï¼‰**  
   ã™ã¹ã¦ã®ç·¨é›†æ“ä½œã¯ã‚³ãƒãƒ³ãƒ‰åŒ–ã•ã‚Œã€Undo/Redo å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã€‚

3. **UI çŠ¶æ…‹ã¨ 3DSS ãƒ‡ãƒ¼ã‚¿ã®åˆ†é›¢**  
   3DSS ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã« UI çŠ¶æ…‹ï¼ˆé¸æŠãƒ»ã‚«ãƒ¡ãƒ©ãƒ»åˆ—æ§‹æˆãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç­‰ï¼‰ã‚’æ··å…¥ã•ã›ãªã„ã€‚  
   æ°¸ç¶šåŒ–ãŒå¿…è¦ãªå ´åˆã¯ **åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆsidecarï¼‰** ã§æ‰±ã†ã€‚

4. **è¦ç´ ãƒ­ãƒƒã‚¯ï¼ˆLevel 1ï¼‰ã«ã‚ˆã‚‹èª¤æ“ä½œé˜²æ­¢**  
   è¦ç´ å˜ä½ã® lock ã‚’æä¾›ã—ã€lock è¦ç´ ã¯ Transform / Delete / Property Save / LineEditor Apply ã®å¯¾è±¡å¤–ã¨ã™ã‚‹ã€‚  
   lock ã¯ 3DSS ã¸æ··å…¥ã•ã›ãšã€å¿…è¦ãªã‚‰ **sidecar** ã«ä¿æŒã™ã‚‹ã€‚

5. **å¿ å®Ÿãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆç‰¹ã« text_poseï¼‰**  
   `text_pose`ï¼ˆfront/up vec3ï¼‰ã‚’æ­£ã—ãè§£é‡ˆã—ã€modeler ã§ã‚‚ viewer ã¨åŒç­‰ã®å‘ãã§è¡¨ç¤ºã™ã‚‹ã€‚

6. **è²¬å‹™åˆ†é›¢ï¼ˆentry / hub / core / renderer / uiï¼‰**  
   viewer ã¨åŒä¸€ã®ãƒ¬ã‚¤ãƒ¤ãƒªãƒ³ã‚°è¦å‰‡ã‚’è¸è¥²ã—ã€ä¾å­˜æ–¹å‘ã‚’å›ºå®šã™ã‚‹ã€‚

## 0.6 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼šãƒ¬ã‚¤ãƒ¤ã¨è²¬å‹™ï¼šãƒ¬ã‚¤ãƒ¤ã¨è²¬å‹™

modeler ã¯æ¬¡ã®ãƒ¬ã‚¤ãƒ¤ã«åˆ†é›¢ã™ã‚‹ã€‚

- **entry**ï¼šcomposition rootï¼ˆèµ·å‹•ãƒ»DI ã®ã¿ï¼‰
- **hub**ï¼šUI ã¨ core/renderer ã®ä»²ä»‹ï¼ˆãƒ­ã‚¸ãƒƒã‚¯æœ€å°åŒ–ï¼‰
- **core**ï¼šãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç·¨é›†ãƒ­ã‚¸ãƒƒã‚¯ã€ã‚³ãƒãƒ³ãƒ‰å±¥æ­´ã€æ¤œè¨¼ã€IR
- **renderer**ï¼šthree.js æç”»ã€pickï¼ˆraycastï¼‰/ é¸æŠãƒã‚¤ãƒ©ã‚¤ãƒˆï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
- **ui**ï¼šãƒ†ãƒ¼ãƒ–ãƒ«ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€ãƒ•ãƒ¬ãƒ¼ãƒ ç·¨é›†ã€å…¥åŠ›ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆDOMï¼‰

### ä¾å­˜æ–¹å‘ï¼ˆæ­£æ–¹å‘ / ç¦æ­¢ï¼‰

- è¨±å¯ï¼ˆæ­£æ–¹å‘ï¼‰
  - ui â†’ entry / hub
  - entry â†’ hub / core / renderer
  - hub â†’ core / renderer

- ç¦æ­¢ï¼ˆçµ¶å¯¾ï¼‰
  - core â†’ hub / renderer / ui
  - renderer â†’ core / hub / ui
  - hub â†’ ui
  - ui â†’ rendererï¼ˆpick ã‚’å«ã‚€ï¼‰â€»å¿…ãš hub çµŒç”±

## 0.7 ä¾å­˜æ³¨å…¥ï¼ˆDIï¼‰ã¨ composition root

- composition root ã¯ entryï¼ˆä¾‹ï¼š`bootstrapModeler`ï¼‰ã¨ã™ã‚‹ã€‚
- core / renderer ã¯ import ã«ã‚ˆã‚‹å¯†çµåˆã‚’é¿ã‘ã€`createXxx({deps})` ã§æ³¨å…¥ã™ã‚‹ã€‚
- hub ã¯ `{ core, renderer }` ã‚’å—ã‘å–ã‚Šã€å¤–éƒ¨ API ã‚’æŸã­ã‚‹ã€‚

## 0.8 ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ï¼ˆstart/stop/disposeï¼‰

- `hub.start()/stop()/dispose()` ã¯ idempotentã€‚
- `stop()` ã¯ RAF åœæ­¢ï¼ˆç·¨é›†çŠ¶æ…‹ã¯ä¿æŒï¼‰ã€‚
- `dispose()` ã¯ stop + renderer è³‡æºè§£æ”¾ã€‚ä»¥å¾Œ API ã¯ no-opï¼ˆä¾‹å¤–ç¦æ­¢ï¼‰ã€‚

## 0.9 çŠ¶æ…‹æ‰€æœ‰æ¨©ï¼ˆsingle-writerï¼‰

- 3DSS ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆç·¨é›†å¯¾è±¡ï¼‰ã¯ core ãŒæ‰€æœ‰ã™ã‚‹ã€‚
- UI ã¯ core ã®å…¬é–‹ APIï¼ˆã‚³ãƒãƒ³ãƒ‰ï¼‰ã‚’é€šã˜ã¦ã®ã¿ç·¨é›†ã™ã‚‹ã€‚
- single-writerï¼š
  - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°ã¯ **CommandManager ã®ã¿**
  - `uiState.selection` ã®æ›´æ–°ã¯ **SelectionController ã®ã¿**
  - `uiState.camera` ã®æ›´æ–°ã¯ **CameraEngine ã®ã¿**


# 1 ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“æ§‹é€ ãƒ»å†…éƒ¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆmodelerï¼‰

## 1.1 ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ

modeler ã¯æœ€å°ã§æ¬¡ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç¾¤ã‚’æŒã¤ã€‚

- entryï¼š`bootstrapModeler()` / DI / èµ·å‹•ã‚ªãƒ—ã‚·ãƒ§ãƒ³è§£æ±º
- hubï¼šModelerHubï¼ˆUIâ‡”Core/Renderer ã®é›†ç´„ APIï¼‰
- coreï¼šDocumentCore / CommandManager / SelectionModel / IR / Validation
- rendererï¼šSceneRenderer / PickService / GizmoService / TextBillboard/Planeï¼ˆå®Ÿè£…é¸æŠï¼‰
- uiï¼šOutlinerTable / PropertyPanel / FramesEditor / Shortcuts
- validatorï¼šAjvStrict / QuickCheckï¼ˆè¨ºæ–­ï¼‰
- ioï¼šFileSystemAccessï¼ˆFSAï¼‰/ drag&drop / export
- utilsï¼šmathï¼ˆvec3/quatï¼‰/ poseï¼ˆfront/upï¼‰/ normalizeï¼ˆenum ç­‰ï¼‰

### 1.1.1 â€œå…±é€šåŒ–â€ã®æ‰±ã„

viewer/modeler ã§å…±é€šåŒ–ã™ã‚‹å®Ÿè£…ï¼ˆshared packageï¼‰ãŒå­˜åœ¨ã™ã‚‹å ´åˆã§ã‚‚ã€
modeler ã®è²¬å‹™ã¨ã—ã¦ **write-enabled ã®ç·¨é›†ã‚³ã‚¢ã¯ modeler å´ã«é–‰ã˜ã‚‹**ã€‚

- å…±æœ‰å€™è£œï¼šschema validationã€pose mathã€æç”»ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ã€FSA wrapperã€ãƒ­ã‚°æ•´å½¢
- éå…±æœ‰ï¼ˆåŸå‰‡ï¼‰ï¼šCommandManagerã€Undo/Redoã€SelectionModelã€ç·¨é›† UI çŠ¶æ…‹æ©Ÿæ¢°

## 1.2 Coreï¼ˆeditable state ã¨ç·¨é›†ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼‰

Core ã¯ **ç·¨é›†å¯èƒ½ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆçŠ¶æ…‹**ã‚’ä¿æŒã—ã€Command ã«ã‚ˆã‚Šå¤‰æ›´ã‚’é©ç”¨ã™ã‚‹ã€‚

- DocumentStateï¼š3DSS æ§‹é€ ï¼ˆstrict å‡ºåŠ›å¯èƒ½ãªçŠ¶æ…‹ï¼‰
- AuthoringStateï¼šIR / æœªç¢ºå®šãƒ»ä½™å‰°ã®éš”é›¢ï¼ˆstrict å‡ºåŠ›å¯¾è±¡å¤–ï¼‰
- CommandManagerï¼šapply/undo/redoã€å±¥æ­´ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œ
- SelectionModelï¼šé¸æŠé›†åˆã€ãƒã‚¤ãƒ©ã‚¤ãƒˆã€ãƒ­ãƒƒã‚¯ç­‰ï¼ˆUIçŠ¶æ…‹ã€‚3DSSã¸ã¯æ··å…¥ã—ãªã„ï¼‰

## 1.3 ä¾å­˜é–¢ä¿‚ï¼ˆcore ä¸»å°ï¼‰

- hub ã¯ core/renderer ã‚’å‘¼ã³å‡ºã™ãŒã€çŠ¶æ…‹ã® SSOT ã¯ core ã«ç½®ãã€‚
- renderer ã¯ **å‚ç…§å°‚ç”¨ã® Snapshot** ã‚’å—ã‘å–ã‚Šæç”»ã™ã‚‹ï¼ˆrenderer ãŒ core ã‚’æ›´æ–°ã—ãªã„ï¼‰ã€‚
- ui ã¯ hub ã®å…¬é–‹ API ã®ã¿å‘¼ã¶ï¼ˆcore/renderer ã‚’ç›´æ¥è§¦ã‚‰ãªã„ï¼‰ã€‚

## 1.4 å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è²¬å‹™

### 1.4.1 entryï¼ˆbootstrapModelerï¼‰

- èµ·å‹•å¼•æ•°ãƒ»URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ»dev harness ç”±æ¥ã®è¨­å®šè§£æ±º
- DI æ§‹ç¯‰ï¼ˆcreateCore/createRenderer/createHubï¼‰
- start/stop/dispose ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†

### 1.4.2 hubï¼ˆModelerHubï¼‰

- UI ã‹ã‚‰è¦‹ãŸå”¯ä¸€ã® API
- ã‚³ãƒãƒ³ãƒ‰ã®ç™ºè¡Œï¼ˆcreate/move/rotate/edit props ç­‰ï¼‰
- pick çµæœã®è§£æ±ºï¼ˆrenderer â†’ hub â†’ core ã§ selection æ›´æ–°ï¼‰
- renderer ã¸ã® â€œæç”»æ›´æ–°è¦æ±‚â€ ã¨ frame å†ç”Ÿåˆ¶å¾¡

### 1.4.3 coreï¼ˆDocumentCoreï¼‰

- Importï¼ˆå¯›å®¹ï¼‰â†’ IR ç”Ÿæˆ â†’ strict å‡ºåŠ›å¯èƒ½ãª DocumentState ã¸ã®åæŸï¼ˆExport æ™‚ï¼‰
- strict validateï¼ˆAJVï¼‰ãŠã‚ˆã³ Quick Check ã®ç™ºè¡Œ
- ã‚³ãƒãƒ³ãƒ‰ã®æ•´åˆæ€§ï¼ˆä¾‹ï¼šUUID ä¸€æ„æ€§ã€å‚ç…§æ•´åˆã€frames å€¤åŸŸï¼‰

### 1.4.4 rendererï¼ˆSceneRendererï¼‰

- three.js ã‚·ãƒ¼ãƒ³æ§‹ç¯‰ã€æç”»
- pickï¼ˆraycastï¼‰ãƒ»ãƒ’ãƒƒãƒˆãƒ†ã‚¹ãƒˆãƒ»ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- text_pose ã®è§£é‡ˆï¼ˆfront/upï¼‰ã«åŸºã¥ãæ–‡å­—å‘ãè¡¨ç¤ºï¼ˆmarker.text / caption_text / latexï¼‰

### 1.4.5 uiï¼ˆOutliner / Property / Framesï¼‰

- OutlinerTableï¼šè¦ç´ ã®ä¿¯ç°ãƒ»æ¤œç´¢ãƒ»ã‚½ãƒ¼ãƒˆãƒ»æœ€å°é™ã®åˆ—ç·¨é›†
- PropertyPanelï¼šè¦ç´ ã®è©³ç´°ç·¨é›†ï¼ˆappearance/meta/label/poseï¼‰
- FramesEditorï¼šframes ä¸€è¦§ãƒ»å†ç”Ÿãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼åˆ¶å¾¡ãƒ»ç¯„å›²ç·¨é›† UIï¼ˆâ€»ä¿å­˜ã¯ strict å‹ã«å¤‰æ›ï¼‰
- Shortcutsï¼šã‚­ãƒ¼å…¥åŠ›ï¼ˆãŸã ã—å®Ÿå‡¦ç†ã¯ hub ã¸ï¼‰

### 1.4.6 validator

- AjvStrictï¼š3DSS.schema.json ã«ã‚ˆã‚‹ strict validateï¼ˆExport/Save ã§å¿…é ˆï¼‰
- QuickCheckï¼šImport/ç·¨é›†ä¸­ã®è¨ºæ–­ï¼ˆwarning ä¸­å¿ƒã€strict failure ã§ã‚‚ç¶™ç¶šå¯ï¼‰

### 1.4.7 io

- Open/Save/Save Asï¼šFSA ã‚’ç¬¬ä¸€é¸æŠï¼ˆfallback ã¯ download/uploadï¼‰
- Exportï¼šstrict 3DSS ã®ç”Ÿæˆã¨å‡ºåŠ›ï¼ˆsidecar ä½µç”¨å¯ï¼‰

## 1.5 I/Oï¼ˆmodeler æ¦‚è¦ï¼‰

- Openï¼š`.3dss.json`ï¼ˆstrictï¼‰/ `.3dss-prep.json`ï¼ˆå¯›å®¹ï¼‰ã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘ã‚‹
- Save/Save Asï¼š**strict 3DSS** ã‚’ä¿å­˜ã™ã‚‹ï¼ˆImport ä½™å‰°ã¯ extras ã«ä¿æŒã—ã€3DSS æœ¬ä½“ã¸ã¯å‡ºåŠ›ã—ãªã„ï¼‰
- Exportï¼šå…±æœ‰ç”¨ã® strict 3DSS ã‚’ç”Ÿæˆï¼ˆå¿…è¦ã«å¿œã˜ã¦ flatten/normalize ã‚’å®Ÿæ–½ï¼‰
- Import æ™‚ã®ä½™å‰°ä¿æŒï¼š
  - æ—¢çŸ¥å¤–ã‚­ãƒ¼ç­‰ã¯ **extras** ã«éš”é›¢ã—ã€3DSS æœ¬ä½“ã¸ã¯å‡ºåŠ›ã—ãªã„
  - extras ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ QuickCheck ã« info ã‚’å‡ºã™ï¼ˆä¸€è¦§è¡¨ç¤ºã§å¯ï¼‰

## 1.6 ç¦æ­¢äº‹é …ï¼ˆmodeler å…¨ä½“ï¼‰

- 3DSS å‡ºåŠ›ã« unknown fields ã‚’æ··å…¥ã•ã›ã‚‹è£œé–“ï¼ˆã‚³ãƒ³ã‚¿ãƒŸï¼‰
- renderer ãŒ core ã‚’ç›´æ¥æ›´æ–°ã™ã‚‹è¨­è¨ˆï¼ˆsingle-writer ç ´ã‚Šï¼‰
- UI çŠ¶æ…‹ï¼ˆé¸æŠãƒ»ã‚«ãƒ¡ãƒ©ãƒ»åˆ—ãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç­‰ï¼‰ã‚’ 3DSS ã«ä¿å­˜ã™ã‚‹
- å¤–éƒ¨é€ä¿¡ï¼ˆè¿½è·¡ãƒ»ãƒ­ã‚°é€ä¿¡ãƒ»ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ‰åŠ¹ã«ã™ã‚‹

## 1.7 èµ·å‹•ãƒ•ãƒ­ãƒ¼

dev harness / æœ¬ç•ªåŸ‹ã‚è¾¼ã¿ã®å·®ã¯ã‚ã£ã¦ã‚‚ã€èµ·å‹•ã® SSOT ã¯ `bootstrapModeler` ã¨ã™ã‚‹ã€‚

- harness â†’ bootstrapModeler â†’ createCore/createRenderer â†’ createHub â†’ hub.start()
- Openï¼ˆåˆæœŸãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆï¼‰ï¼šhub.openFile(...) â†’ core.importNormalize(raw) â†’ core.document.set(strictDoc + extras) â†’ renderer.update(snapshot)

## 1.8 dev modeler ã¨æœ¬ç•ª modeler

- dev modelerï¼šãƒ­ãƒ¼ã‚«ãƒ«/é–‹ç™ºç”¨ï¼ˆãƒ­ã‚°ãƒ»è¨ºæ–­ UI ã‚’å«ã‚€ã“ã¨ãŒã‚ã‚‹ï¼‰
- æœ¬ç•ª modelerï¼šå…¬é–‹ UIï¼ˆè¨ºæ–­ã¯å¿…è¦æœ€å°ã®è¡¨ç¤ºï¼‰

ä¸¡è€…ã¯ **åŒä¸€ã® entry/core/renderer/hub** ã‚’å…±æœ‰ã—ã€å·®åˆ†ã¯ UI å±¤ã«é–‰ã˜ã‚‹ã€‚

## 1.9 baseline èµ·å‹•æ™‚ã®å›ºå®šæ¡ä»¶

- coordinate_systemï¼šZ+up/freeXY ã‚’å‰æï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å€¤ãŒé•ã†å ´åˆã¯ QuickCheck warningï¼‰
- unitsï¼šnon_si:px ã‚’æ¨å¥¨ï¼ˆç•°ãªã‚‹å ´åˆã¯è¡¨ç¤ºä¸Šã®å˜ä½è¡¨è¨˜ã«åæ˜ ã™ã‚‹ãŒã€åº§æ¨™å€¤ã¯å¤‰æ›ã—ãªã„ï¼‰



## 1.10 Preview Outï¼ˆäºŒé¢è¡¨ç¤º / å¤–éƒ¨è¡¨ç¤ºï¼‰

modeler ã¯ã€ç·¨é›†ä¸­ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ **å¤–éƒ¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦**ã¸å‡ºåŠ›ã§ãã‚‹ï¼ˆä¾‹ï¼šåˆ¥ãƒ¢ãƒ‹ã‚¿ã§ã®ç¢ºèªï¼‰ã€‚

- å¤–éƒ¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦: `preview_out.html`
- æ—¢å®šãƒ¢ãƒ¼ãƒ‰: **Independent view**ï¼ˆå¤–éƒ¨å´ã§ç‹¬ç«‹ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã€ç”»è§’ã‚‚ç‹¬ç«‹ï¼‰
- UI:
  - Followï¼šé¸æŠä¸­è¦ç´ ã¸è¿½å¾“ï¼ˆå¤–éƒ¨å´ã‚«ãƒ¡ãƒ©ã®ã¿ï¼‰
  - Frameï¼šé¸æŠä¸­è¦ç´ ã¸ãƒ•ãƒ¬ãƒ¼ãƒŸãƒ³ã‚°ï¼ˆå¤–éƒ¨å´ã‚«ãƒ¡ãƒ©ã®ã¿ï¼‰
  - Pickï¼šOFF æ—¢å®šã€‚ON ã®å ´åˆã€å¤–éƒ¨å´ã®ã‚¯ãƒªãƒƒã‚¯ã§ main window ã® selection ã‚’æ›´æ–°ã™ã‚‹

### 1.10.1 focus-modeï¼ˆä»»æ„ï¼‰

Preview Out ã‚’é–‹ã„ã¦ã„ã‚‹é–“ã€main window ã®åŸ‹ã‚è¾¼ã¿ preview pane ã‚’æŠ˜ã‚ŠãŸãŸã‚€ã€Œfocus-modeã€ã‚’æä¾›ã—ã¦ã‚ˆã„ã€‚  
æ—¢å®šã¯ OFF ã¨ã—ã€äºŒé¢è¡¨ç¤ºï¼ˆåˆ¥ç”»è§’ï¼‰ãŒåŒæ™‚ã«è¦‹ãˆã‚‹çŠ¶æ…‹ã‚’åŸºæœ¬ã¨ã™ã‚‹ã€‚

### 1.10.2 mirror ãƒ¢ãƒ¼ãƒ‰ï¼ˆä»»æ„ãƒ»ãƒ‡ãƒãƒƒã‚°ï¼‰

`preview_out.html?mirror=1` ã®ã‚ˆã†ãªã‚ªãƒ—ãƒˆã‚¤ãƒ³ã§ã€main window ã® canvas ã‚’ `captureStream()` ã—ã¦ video ã§ãƒŸãƒ©ãƒ¼è¡¨ç¤ºã—ã¦ã‚ˆã„ã€‚  
ãŸã ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶åˆ¶ç´„ï¼ˆautoplay ç­‰ï¼‰ã§å¤±æ•—ã™ã‚‹å ´åˆãŒã‚ã‚‹ãŸã‚ã€å¤±æ•—æ™‚ã¯ Independent view ã¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã™ã‚‹ã“ã¨ã€‚

### 1.10.3 å¤–éƒ¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è¦æ±‚ã‚µã‚¤ã‚ºã¨ãƒ¡ã‚¤ãƒ³æç”»

å¤–éƒ¨è¡¨ç¤ºãŒå°ã•ããƒœã‚±ã‚‹ã®ã‚’é¿ã‘ã‚‹ãŸã‚ã€Preview Out ã¯è‡ªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è¡¨ç¤ºã‚µã‚¤ã‚ºï¼ˆCSS pxï¼‰ã‚’ main window ã«é€šçŸ¥ã—ã¦ã‚ˆã„ã€‚  
main window å´ã¯ã€åŸ‹ã‚è¾¼ã¿ preview ã®è¡¨ç¤ºã‚µã‚¤ã‚ºã‚ˆã‚Šå¤–éƒ¨è¦æ±‚ã‚µã‚¤ã‚ºãŒå¤§ãã„å ´åˆã€**å¤§ãã„æ–¹**ã‚’æç”»è§£åƒåº¦ã¨ã—ã¦ç¢ºä¿ã™ã‚‹ï¼ˆçµæœã‚’ä¸¡æ–¹ã§å…±æœ‰ã—ã¦ã‚‚ã‚ˆã„ï¼‰ã€‚


# 2 ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨ã‚¹ã‚­ãƒ¼ãƒæº–æ‹ ï¼ˆç·¨é›†å´è¦–ç‚¹ï¼‰

## 2.1 modeler ãŒæ‰±ã†å…¥åŠ›å½¢å¼

modeler ã¯æ¬¡ã‚’å…¥åŠ›ã¨ã—ã¦æ‰±ã†ã€‚

- `.3dss.json`ï¼š3DSS æ§‹é€ å±¤ï¼ˆstrictï¼‰
- `.3dss-prep.json`ï¼šAuthoring å±¤ã®å—ã‘æ¸¡ã—ï¼ˆpermissiveï¼‰â€»æ¨å¥¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

### 2.1.1 Importï¼ˆpermissiveï¼‰ã®è¦å‰‡

- required æ¬ è½ã‚„ unknown fields ã‚’æ¤œå‡ºã—ã¦ã‚‚ã€**å¯èƒ½ãªé™ã‚Šèª­è¾¼ã‚’ç¶™ç¶š**ã—ã¦ã‚ˆã„
- ãŸã ã—ã€èª­è¾¼ç¶™ç¶šã¯ **IR ã¸ã®éš”é›¢**ã«ã‚ˆã‚Šå®Ÿç¾ã—ã€3DSS æœ¬ä½“ã¸è‡ªå‹•æ··å…¥ã•ã›ãªã„
- å‚ç…§ä¸æ•´åˆï¼ˆä¾‹ï¼šline.endpoint.ref ãŒå­˜åœ¨ã—ãªã„ï¼‰ã¯ã€QuickCheck warning ã¨ã—ã€UI ã§ä¿®æ­£å¯èƒ½ã«ã™ã‚‹

## 2.2 Save / Exportï¼ˆstrictï¼‰ã®è¦å‰‡

- Save / Save As / Export ã¯ **å¸¸ã« strict 3DSS** ã‚’å‡ºåŠ›ã™ã‚‹ï¼ˆAJV strict validate ã‚’é€šã™ï¼‰
- strict ã‚’æº€ãŸã›ãªã„å ´åˆï¼š
  - Save/Export ã¯å¤±æ•—ã¨ã—ã€åŸå› ï¼ˆmissing required ç­‰ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹
  - ãŸã ã—ç·¨é›†ä¸­ã®çŠ¶æ…‹ï¼ˆIRï¼‰ã¯ç ´æ£„ã—ãªã„

### 2.2.0 Dirty state policyï¼ˆæœªä¿å­˜/æœªé©ç”¨ã®æ‰±ã„ï¼‰

- ç·¨é›†ãŒç™ºç”Ÿã—ãŸã‚‰ **dirty** ã¨ã™ã‚‹
- dirty ã¯æ¬¡ã® 2 ç³»çµ±ã«åˆ†ã‘ã¦æ‰±ã£ã¦ã‚ˆã„ï¼š
  - **core dirty**ï¼šå¤‰æ›´ãŒ â€œé©ç”¨æ¸ˆã¿â€ ã¨ã—ã¦ core ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å…¥ã£ãŸçŠ¶æ…‹
  - **extra dirtyï¼ˆæœªé©ç”¨ dirtyï¼‰**ï¼šUIï¼ˆä¾‹ï¼šproperty ãƒ‘ãƒãƒ«ï¼‰ã®æœªé©ç”¨ç·¨é›†ãŒæ®‹ã£ã¦ã„ã‚‹çŠ¶æ…‹
- Save / Save As / Export ã¯ **extra dirty ãŒæ®‹ã‚‹é–“ã¯å®Ÿè¡Œã—ãªã„**ï¼ˆèª¤ä¿å­˜é˜²æ­¢ï¼‰
- Save / Save As / Export ãŒæˆåŠŸã—ãŸã‚‰ **clean** ã«æˆ»ã™
  - Export ã¯ save destinationï¼ˆä¿å­˜å…ˆ/ãƒãƒ³ãƒ‰ãƒ«ï¼‰ã‚’æ›´æ–°ã—ãªã„ï¼ˆã‚ãã¾ã§å…±æœ‰ç”¨å‡ºåŠ›ï¼‰
- strict validate å¤±æ•—ã§ Save/Export ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸå ´åˆã€dirty/extra dirty ã¯ä¿æŒã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¿®æ­£ã‚’ä¿ƒã™


### 2.2.1 sidecarï¼ˆUI çŠ¶æ…‹ãƒ»ä½™å‰°ä¿æŒï¼‰

- UI çŠ¶æ…‹ï¼ˆé¸æŠãƒ»ã‚«ãƒ¡ãƒ©ãƒ»åˆ—ã‚»ãƒƒãƒˆãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç­‰ï¼‰ã‚„ã€Import ç”±æ¥ã®ä½™å‰°æƒ…å ±ã‚’ä¿æŒã—ãŸã„å ´åˆã€
  `*.3dss.sidecar.json` ã‚’ç”¨ã„ã‚‹ï¼ˆ3DSS æœ¬ä½“ã¸ã¯æ··å…¥ã—ãªã„ï¼‰ã€‚
- sidecar ã¯ strict å¥‘ç´„å¤–ã§ã‚ã‚Šã€äº’æ›æ€§ã¯ modeler ã«é–‰ã˜ã‚‹ã€‚

### 2.2.1.1 lockï¼ˆè¦ç´ ãƒ­ãƒƒã‚¯ï¼‰ã®ä¿æŒ

- lock ã¯ **è¦ç´ å˜ä½**ã§ç®¡ç†ã™ã‚‹ï¼ˆpoint/line/auxï¼‰ã€‚
- lock æƒ…å ±ã¯ 3DSS æœ¬ä½“ã«ä¿å­˜ã—ãªã„ã€‚ä¿æŒãŒå¿…è¦ãªå ´åˆã¯ sidecar ã«ä¿å­˜ã™ã‚‹ã€‚
- sidecar ã§ã®è¡¨ç¾ã¯å®Ÿè£…éƒ½åˆã§ã‚ˆã„ãŒã€æœ€ä½é™æ¬¡ã‚’æº€ãŸã™ã“ã¨ï¼š
  - å¯¾è±¡ã¯ uuid ã§å‚ç…§ã™ã‚‹ï¼ˆname/caption ã§ã¯å‚ç…§ã—ãªã„ï¼‰
  - lock ã®æœ‰åŠ¹/ç„¡åŠ¹ãŒå¾©å…ƒã§ãã‚‹



## 2.2.2 Auto Repair Policyï¼ˆè‡ªå‹•è£œå®Œãƒãƒªã‚·ãƒ¼ï¼šImport/permissive å†…ï¼‰

æœ¬ç¯€ã¯ã€Importï¼ˆpermissiveï¼‰æ™‚ã«ã€Œæ¬ è½ / ä¸æ­£ã€ã‚’æ¤œå‡ºã—ãŸå ´åˆã® **è‡ªå‹•è£œå®Œãƒ»æ­£è¦åŒ–ã®è¨±å¯ç¯„å›²**ã‚’å®šã‚ã‚‹ã€‚  
ã“ã“ã§ã®è‡ªå‹•å‡¦ç†ã¯ **IRï¼ˆä¸­é–“è¡¨ç¾ï¼‰ã«é–‰ã˜ã‚‹**ã“ã¨ã‚’åŸå‰‡ã¨ã—ã€3DSS å‡ºåŠ›ï¼ˆSave/Exportï¼‰ã§ã¯ strict validate ã‚’å¿…ãšé€šã™ã€‚

### 2.2.2.1 åˆ†é¡ï¼ˆA/B/Cï¼‰

- **A: å®‰å…¨ãªãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆç¢ºå®šçš„ï¼‰**  
  ã‚¹ã‚­ãƒ¼ãƒã® default / æ˜ç¢ºã«ä¸€æ„ãªè¦å‰‡ã«ã‚ˆã‚Šã€æ¨æ¸¬ã‚’ä¼´ã‚ãšç¢ºå®šã§ãã‚‹è£œå®Œãƒ»æ­£è¦åŒ–ã€‚

- **B: æ©Ÿæ¢°çš„ã«å°å‡ºã§ãã‚‹å€¤ï¼ˆæ±ºå®šçš„ï¼‰**  
  ä»–ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚„å…¥åŠ›å½¢å¼ã‹ã‚‰ **è¨ˆç®—ã§ä¸€æ„**ã«å°å‡ºã§ãã‚‹è£œå®Œãƒ»å¤‰æ›ï¼ˆä¾‹ï¼šUUIDç”Ÿæˆã€ç¯„å›²å±•é–‹ï¼‰ã€‚

- **C: æ„å‘³ãŒçµ¡ã‚€æ¨æ¸¬è£œå®Œï¼ˆç¦æ­¢ï¼‰**  
  â€œãŸã¶ã‚“ã“ã†ã ã‚ã†â€ ã®æ¨æ¸¬ã‚’å«ã‚€è£œå®Œã€‚3DSS æœ¬ä½“ã¸ã®æ··å…¥ï¼ˆã‚³ãƒ³ã‚¿ãƒŸï¼‰ã‚’å¼•ãèµ·ã“ã™ãŸã‚ç¦æ­¢ã€‚

### 2.2.2.2 ãƒ«ãƒ¼ãƒ«ï¼ˆå…±é€šï¼‰

- A/B ã®å‡¦ç†ã‚’è¡Œã£ãŸå ´åˆã€QuickCheck ã« **warning** ã‚’å‡ºã—ã€ã©ã®è¦ç´ ãƒ»ã©ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«é©ç”¨ã—ãŸã‹ã‚’ç¤ºã™ã€‚
- C ã«è©²å½“ã™ã‚‹å•é¡Œã¯è‡ªå‹•ä¿®å¾©ã›ãšã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¿®æ­£ã‚’è¦æ±‚ã™ã‚‹ã€‚æœªè§£æ±ºãŒæ®‹ã‚‹å ´åˆã€Save/Export ã¯å¤±æ•—ã¨ã™ã‚‹ã€‚
- A/B ã¯ Import æ™‚ã« IR ã¸åæ˜ ã—ã¦ã‚ˆã„ãŒã€**Save/Export æ™‚ç‚¹ã§ strict ã¸åæŸ**ã§ããªã„å ´åˆã¯ä¿å­˜ã—ãªã„ã€‚

### 2.2.2.3 å¯¾è±¡åˆ¥ãƒãƒªã‚·ãƒ¼ï¼ˆA/B/Cï¼‰

| å¯¾è±¡ | æ¬ è½ï¼ˆMissingï¼‰ | ä¸æ­£ï¼ˆInvalidï¼‰ | åˆ†é¡ | å‡¦ç†ï¼ˆIRå†…ï¼‰ | Save/Exportæ™‚ã®æ‰±ã„ |
|---|---|---|---|---|---|
| document_meta | `document_meta` æ¬ è½ / required æ¬ è½ | å‹ä¸ä¸€è‡´ãƒ»å¿…é ˆæ¬ è½ | A/B | **B**: ç”Ÿæˆå¯èƒ½ãªã‚‚ã®ã¯ç”Ÿæˆï¼ˆä¾‹ï¼š`document_uuid`ï¼‰ï¼**A**: ã‚¹ã‚­ãƒ¼ãƒæ—¢å®šå€¤ãŒã‚ã‚‹é …ç›®ã¯é©ç”¨ | required ãŒæœªè§£æ±ºãªã‚‰ **ãƒ–ãƒ­ãƒƒã‚¯**ï¼ˆstrict failureï¼‰ |
| uuidï¼ˆmeta.uuidï¼‰ | è¦ç´  uuid æ¬ è½ | é‡è¤‡ / å½¢å¼ä¸æ­£ | B | **B**: æ–°è¦ UUIDv4 ã‚’ç”Ÿæˆï¼ˆæ¬ è½ã®ã¿ï¼‰ã€‚é‡è¤‡ã¯è‡ªå‹•è§£æ¶ˆã›ãšï¼ˆä¸‹æ®µå‚ç…§ï¼‰ | æ¬ è½ãƒ»é‡è¤‡ãŒæ®‹ã‚‹å ´åˆ **ãƒ–ãƒ­ãƒƒã‚¯** |
| framesï¼ˆappearance.framesï¼‰ | æœªè¨­å®š | å‹ä¸ä¸€è‡´ / ç¯„å›²è¡¨è¨˜ / é‡è¤‡ | A/B | **B**: ç¯„å›²è¡¨è¨˜ï¼ˆä¾‹ï¼š`1-10`ï¼‰ã‚’ IR ã§å±•é–‹ã—ã€**A**: sort+unique ã§æ­£è¦åŒ– | Export ã¯ int / int[] ã® strict å‹ã¸å¤‰æ›ã€æœªè§£æ±ºãªã‚‰ **ãƒ–ãƒ­ãƒƒã‚¯** |
| poseï¼ˆtext_pose: front/upï¼‰ | `pose` æ¬ è½ï¼ˆrequiredï¼‰ | vec3ã§ãªã„ / frontã¨upãŒå¹³è¡Œã«è¿‘ã„ | A/C | **A**: ã‚¹ã‚­ãƒ¼ãƒæ—¢å®šï¼ˆã‚ã‚‹å ´åˆï¼‰ã‚’é©ç”¨ã€‚å¹³è¡Œã«è¿‘ã„å ´åˆã¯â€œæç”»ç”¨ã«ç›´äº¤åŒ–â€ã¯å¯ï¼ˆå€¤ã¯ä¿å­˜ã—ãªã„ï¼‰ | required æ¬ è½ã¯ **ãƒ–ãƒ­ãƒƒã‚¯**ã€‚å¹³è¡Œã¯ä¿å­˜å€¤ã®è‡ªå‹•ä¿®æ­£ã¯ç¦æ­¢ï¼ˆwarningï¼‰ |
| alignï¼ˆmarker.text.align ç­‰ï¼‰ | æœªè¨­å®š | æ—§è¡¨è¨˜ãƒ»éæ­£è¦è¡¨è¨˜ | A | **A**: æ­£è¦è¡¨è¨˜ã¸æ­£è¦åŒ–ï¼ˆä¾‹ï¼šæ—§å…¥åŠ›ã‚’ `left&top` ç­‰ã¸ï¼‰ | ä¿å­˜å€¤ã¯å¸¸ã«æ­£è¦è¡¨è¨˜ã€‚è§£é‡ˆä¸èƒ½ãªã‚‰ **ãƒ–ãƒ­ãƒƒã‚¯** |
| refæ•´åˆï¼ˆendpoint.ref ç­‰ï¼‰ | å‚ç…§å…ˆãŒç„¡ã„ | å¾ªç’°ãƒ»ä¸æ•´åˆ | C | **ç¦æ­¢**ï¼šå‚ç…§ã‚’æ¨æ¸¬ã—ã¦ä»˜ã‘æ›¿ãˆãªã„ã€‚IRã«â€œæœªè§£æ±ºâ€ã¨ã—ã¦ä¿æŒã—ã€UIã§ä¿®æ­£ã•ã›ã‚‹ | æœªè§£æ±ºãŒæ®‹ã‚‹å ´åˆ **ãƒ–ãƒ­ãƒƒã‚¯** |

#### è£œè¶³ï¼šuuid é‡è¤‡ã®æ‰±ã„

uuid é‡è¤‡ã¯ â€œæ„å‘³ãŒçµ¡ã‚€æ¨æ¸¬â€ ã‚’å«ã¿å¾—ã‚‹ãŸã‚ã€åŸå‰‡ **è‡ªå‹•è§£æ¶ˆã—ãªã„ï¼ˆCå¯„ã‚Šï¼‰**ã€‚  
ãŸã ã—ã€**æ¬ è½ã¨åŒæ§˜ã«ã€Œæ–°è¦ç”Ÿæˆã—ã¦ã‚‚ä»–ã¨ã®æ„å‘³è¡çªãŒèµ·ã“ã‚‰ãªã„ã€ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ˜ç¤ºæ“ä½œã—ãŸå ´åˆ**ï¼ˆä¾‹ï¼šUIã®ã€ŒRe-generate UUIDã€ãƒœã‚¿ãƒ³ï¼‰ã«é™ã‚Šã€B ã¨ã—ã¦æ‰±ã£ã¦ã‚ˆã„ã€‚

## 2.2.3 Save/Export ã®ãƒ–ãƒ­ãƒƒã‚¯æ¡ä»¶ï¼ˆstrict failuresï¼šå‡ºå£ï¼‰

æœ¬ç¯€ã¯ã€Save / Save As / Exportï¼ˆstrict 3DSS å‡ºåŠ›ï¼‰ã§ **å‡¦ç†ã‚’åœæ­¢ï¼ˆãƒ–ãƒ­ãƒƒã‚¯ï¼‰**ã™ã¹ãæ¡ä»¶ã‚’å®šã‚ã‚‹ã€‚  
ã“ã‚Œã‚‰ã¯ã€Œè‡ªå‹•è£œå®Œã§æ•‘ã†ã€å¯¾è±¡ã§ã¯ãªãã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¿®æ­£ã«ã‚ˆã‚Š strict validate ã‚’æº€ãŸã™ã“ã¨ã‚’è¦æ±‚ã™ã‚‹ã€‚

### 2.2.3.1 ãƒ–ãƒ­ãƒƒã‚¯æ¡ä»¶ï¼ˆä»£è¡¨ä¾‹ï¼‰

- AJV strict validate ã«å¤±æ•—ï¼ˆrequired æ¬ è½ / å‹ä¸ä¸€è‡´ / additionalProperties é•å ç­‰ï¼‰
- `document_meta` ã® required ãŒæœªè§£æ±ºï¼ˆExport æ™‚ç‚¹ã§ strict ã«åæŸã—ã¦ã„ãªã„ï¼‰
- `meta.uuid` ã®æ¬ è½ã¾ãŸã¯é‡è¤‡ãŒæœªè§£æ±ºï¼ˆè¦ç´ è­˜åˆ¥ãŒç¢ºå®šã—ã¦ã„ãªã„ï¼‰
- ref æ•´åˆãŒæœªè§£æ±ºï¼ˆå­˜åœ¨ã—ãªã„ uuid å‚ç…§ã€endpoint.ref ãŒè§£æ±ºä¸èƒ½ ç­‰ï¼‰
- `frames` ãŒ strict å‹ï¼ˆinteger / integer[]ï¼‰ã«å¤‰æ›ä¸èƒ½ï¼ˆIR ãŒæœªè§£æ±ºï¼‰
- `text_pose` ã® required æ¬ è½ï¼ˆä¾‹ï¼š`marker.text.pose` ãªã© required ã®ã¾ã¾æœªè§£æ±ºï¼‰
- `align` ãŒè§£é‡ˆä¸èƒ½ï¼ˆæ­£è¦è¡¨è¨˜ã¸æ­£è¦åŒ–ã§ããªã„ï¼‰

### 2.2.3.2 ãƒ–ãƒ­ãƒƒã‚¯æ™‚ã®æŒ™å‹•

- Save/Export ã‚’å¤±æ•—ã¨ã—ã¦çµ‚äº†ã—ã€**åŸå› ä¸€è¦§**ï¼ˆå¯¾è±¡uuid + ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰path + expected/actual + messageï¼‰ã‚’æç¤ºã™ã‚‹ã€‚
- IRï¼ˆæœªç¢ºå®šçŠ¶æ…‹ï¼‰ã¯ç ´æ£„ã—ãªã„ã€‚
- å¯èƒ½ãªã‚‰è©²å½“è¦ç´ ã¸ã‚¸ãƒ£ãƒ³ãƒ—ï¼ˆOutliner/Propertyï¼‰ã§ãã‚‹å°ç·šã‚’æä¾›ã™ã‚‹ã€‚

#### UI å°ç·šï¼ˆExport å¤±æ•—æ™‚ï¼‰

Save / Export ã‚’å®Ÿè¡Œã—ãŸçµæœ `error` ãŒæ®‹ã£ã¦ã„ã‚‹å ´åˆã€modeler ã¯ **Export ã‚’ä¸­æ–­**ã—ã€æ¬¡ã®å°ç·šã§ä¿®æ­£ã«èª˜å°ã™ã‚‹ã€‚

1. **Save/Export ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆã¾ãŸã¯ QuickCheck ãƒ‘ãƒãƒ«ï¼‰**ã‚’é–‹ãã€`error` ä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹  
   - æ—¢å®šã¯ `error` ã®ã¿è¡¨ç¤ºï¼ˆå¿…è¦ãªã‚‰ `warn` ã‚’å±•é–‹ï¼‰
   - ä¸¦ã³é †ã¯ `kind â†’ uuid â†’ path` ã§å®‰å®šã•ã›ã‚‹ï¼ˆå†ç¾æ€§ã®ãŸã‚ï¼‰

2. ä¸€è¦§ã® **1è¡Œ = 1 Issue** ã¨ã—ã€è¡Œã‚¯ãƒªãƒƒã‚¯ã§ **ãƒ•ã‚©ãƒ¼ã‚«ã‚¹é·ç§»**ã™ã‚‹  
   - `uuid != null`ï¼šOutliner ã§è©²å½“è¡Œã‚’é¸æŠã—ã€PropertyPanel ã‚’é–‹ã
   - `uuid == null`ï¼ˆdocumentå•é¡Œï¼‰ï¼šDocumentMeta/Frames ç­‰ã®è©²å½“ãƒ‘ãƒãƒ«ã¸é·ç§»ã™ã‚‹

3. PropertyPanel ã§ã¯ `path` ã«å¯¾å¿œã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¾ã§ **ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‹ãƒã‚¤ãƒ©ã‚¤ãƒˆ**ã™ã‚‹  
   - UI ãŒ `path` ã‚’ç›´æ¥å¯¾å¿œã§ããªã„å ´åˆã§ã‚‚ã€æœ€ä½é™ã€Œè©²å½“ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã€ã¸ç§»å‹•ã—ã€`path` ã‚’è¡¨ç¤ºã™ã‚‹

4. `ref` ä¸æ•´åˆãªã© â€œä¿®æ­£å…ˆãŒè¤‡æ•°å€™è£œâ€ ã®å ´åˆã¯ã€Issue ã« `hint` ã‚’ä»˜ä¸ã—ã€ä¿®æ­£ã®æ‰‹é †ã‚’æç¤ºã™ã‚‹ï¼ˆ6.2 å‚ç…§ï¼‰

5. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä¿®æ­£ã‚’è¡Œã£ãŸã‚‰ QuickCheck ã‚’å†å®Ÿè¡Œã—ã€`error=0` ã«ãªã‚‹ã¾ã§ Save/Export ã‚’è¨±å¯ã—ãªã„

#### ãƒ•ã‚©ãƒ¼ã‚«ã‚¹é·ç§» APIï¼ˆä»•æ§˜ï¼‰

UI ã¯æ¬¡ã®æœ€å° API ã‚’æŒã¤ï¼ˆå†…éƒ¨å®Ÿè£…ã¯å•ã‚ãªã„ï¼‰ã€‚

- `focusByIssue(issue)`ï¼šIssue ã‚’å—ã‘å–ã‚Šã€Outliner/Property ã‚’åŒæœŸã—ã€è©²å½“ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¸èª˜å°ã™ã‚‹
- `selectByUuid(uuid)`ï¼šOutliner é¸æŠã‚’ uuid ã§è¡Œã†ï¼ˆé…åˆ—indexã§ã¯è¡Œã‚ãªã„ï¼‰
- `openProperty(uuid | "document")`ï¼šPropertyPanel ã‚’é–‹ã
- `revealPath(path)`ï¼šPropertyPanel å†…ã§è©²å½“ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹



## 2.2.4 Import ã®è‡´å‘½æ¡ä»¶ï¼ˆfatalï¼šå…¥å£ï¼‰

Importï¼ˆpermissiveï¼‰ã¯ã€Œèª­ã‚ã‚‹ã¨ã“ã‚ã¾ã§èª­ã‚€ã€ã‚’åŸå‰‡ã¨ã—ã€åœæ­¢ã¯ **ä¾‹å¤–çš„**ã¨ã™ã‚‹ã€‚  
åœæ­¢ï¼ˆfatalï¼‰ã¨ã™ã‚‹ã®ã¯ã€IR æ§‹ç¯‰ã‚„ç·¨é›†ç¶™ç¶šãŒæŠ€è¡“çš„ã«ä¸å¯èƒ½ãªå ´åˆã«é™ã‚‹ã€‚

### 2.2.4.1 fatal æ¡ä»¶ï¼ˆæœ€å°ï¼‰

- JSON è§£æã«å¤±æ•—ï¼ˆæ§‹æ–‡ã‚¨ãƒ©ãƒ¼ç­‰ã§ãƒ‘ãƒ¼ã‚¹ä¸èƒ½ï¼‰
- ãƒ«ãƒ¼ãƒˆãŒ object ã§ãªãã€IR ã®æ§‹ç¯‰ãŒä¸å¯èƒ½ï¼ˆä¾‹ï¼šé…åˆ—/æ–‡å­—åˆ—ã®ã¿ï¼‰
- å®Ÿè£…ä¸Šã®åˆ¶é™ã«ã‚ˆã‚Šå‡¦ç†ä¸èƒ½ï¼ˆä¾‹ï¼šæ¥µç«¯ã«å·¨å¤§ã§ãƒ¡ãƒ¢ãƒªãƒ»æ™‚é–“åˆ¶ç´„ã‚’è¶…éï¼‰

### 2.2.4.2 fatal ã§ãªã„ï¼ˆwarnã§ç¶™ç¶šã™ã‚‹ï¼‰ä¾‹

- `schema_uri` ãŒæƒ³å®šå¤–ï¼ä¸æ˜ï¼ˆäº’æ›ãƒ¬ã‚¤ãƒ¤ãŒç„¡ã„å ´åˆã§ã‚‚ã€å¯èƒ½ãªç¯„å›²ã§èª­è¾¼ã¿ã‚’ç¶™ç¶šã— warning ã‚’å‡ºã™ï¼‰
- unknown fields / æ—§è¡¨è¨˜ / required æ¬ è½ï¼ˆIR ã«éš”é›¢ã—ã€ç·¨é›†ã§è§£æ¶ˆã‚’ä¿ƒã™ï¼‰


## 2.2.5 ç—•è·¡ä¿æŒãƒãƒªã‚·ãƒ¼ï¼ˆIR / sidecar / ãƒ­ã‚°ï¼‰

æœ¬ç¯€ã¯ã€Importï¼ˆpermissiveï¼‰ã‚„ç·¨é›†ä¸­ã«ç™ºç”Ÿã™ã‚‹ â€œç—•è·¡â€ï¼ˆæ¬ è½ãƒ»ä½™å‰°ãƒ»è‡ªå‹•æ­£è¦åŒ–ãƒ»æœªè§£æ±ºäº‹é …ç­‰ï¼‰ã‚’ **ã©ã“ã«ä¿æŒã™ã‚‹ã‹**ã‚’æœ€å°ãƒ«ãƒ¼ãƒ«ã¨ã—ã¦å›ºå®šã™ã‚‹ã€‚  
æœ€çµ‚æˆæœç‰©ã§ã‚ã‚‹ strict 3DSSï¼ˆ`.3dss.json`ï¼‰ã¸ç—•è·¡ã‚’æ··å…¥ï¼ˆã‚³ãƒ³ã‚¿ãƒŸï¼‰ã•ã›ãªã„ã“ã¨ã€‚

### 2.2.5.1 å½¹å‰²åˆ†æ‹…ï¼ˆè¦ç‚¹ï¼‰

| ç½®ãå ´ | ç›®çš„ | æ°¸ç¶š | ä»£è¡¨ä¾‹ | strict 3DSS ã¸ã®æ··å…¥ |
|---|---|---:|---|---|
| **IRï¼ˆä¸­é–“è¡¨ç¾ï¼‰** | permissive Import ã¨ç·¨é›†ä¸­ã®æœªç¢ºå®šçŠ¶æ…‹ã‚’ä¿æŒï¼ˆä½œæ¥­ä¸­ã ã‘ï¼‰ | ã„ã„ãˆ | unknown fieldsã€ç¯„å›²è¡¨è¨˜ã€æœªè§£æ±º refã€ä¸‹æ›¸ãå…¥åŠ› | **ç¦æ­¢** |
| **sidecar**ï¼ˆ`*.3dss.sidecar.json`ï¼‰ | â€œæ¬¡å›å†é–‹â€ã®ãŸã‚ã®çŠ¶æ…‹ã‚’ä¿æŒï¼ˆä½œæ¥­æ”¯æ´ï¼‰ | ã¯ã„ï¼ˆä»»æ„ï¼‰ | lockã€åˆ—ã‚»ãƒƒãƒˆã€UIãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€ã‚«ãƒ¡ãƒ©ã€Import ç”±æ¥ã®ä½™å‰°ä¿æŒã€QuickCheckã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ | **ç¦æ­¢** |
| **ãƒ­ã‚°**ï¼ˆruntimeï¼‰ | è¨ºæ–­ãƒ»ãƒ‡ãƒãƒƒã‚°ï¼ˆãã®å ´ã§è¦‹ã‚‹ï¼‰ | æ—¢å®šã¯ã„ã„ãˆ | BOOT/DOC/EDIT/VALIDATE/IOã€QuickCheckä¸€è¦§ã€auto-repairé©ç”¨è¨˜éŒ² | **ç¦æ­¢** |

### 2.2.5.2 å›ºå®šãƒ«ãƒ¼ãƒ«ï¼ˆæœ€å°ï¼‰

- **Save/Exportï¼ˆstrictï¼‰**ã¯ `.3dss.json` ã®ã¿ã‚’å¯¾è±¡ã¨ã—ã€IR/sidecar/ãƒ­ã‚°ç”±æ¥ã®æƒ…å ±ã‚’æ··å…¥ã—ãªã„ã€‚
- IR ã¯ â€œå¯›å®¹ã•â€ ã®å—ã‘çš¿ã§ã‚ã‚Šã€**æœªè§£æ±ºã‚’æœªè§£æ±ºã®ã¾ã¾ä¿æŒ**ã—ã¦ã‚ˆã„ï¼ˆãŸã ã— 2.2.3 ã®æ¡ä»¶ã§å‡ºå£ã¯æ­¢ã¾ã‚‹ï¼‰ã€‚
- sidecar ã¯ UI çŠ¶æ…‹ãŠã‚ˆã³ä½œæ¥­å†é–‹ã«å¿…è¦ãªç—•è·¡ã®ã¿ã‚’ä¿æŒã—ã€è¦ç´ å‚ç…§ã¯ **å¿…ãš uuid** ã‚’ç”¨ã„ã‚‹ï¼ˆé…åˆ—indexã‚„nameã§å‚ç…§ã—ãªã„ï¼‰ã€‚
- sidecar ã¯å¯¾è±¡ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã« **ãƒã‚¤ãƒ³ãƒ‰**ã•ã‚Œã‚‹ã“ã¨ï¼ˆä¾‹ï¼š`document_meta.document_uuid` ã‚’ä¿æŒã—ã€ç•°ãªã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸èª¤é©ç”¨ã—ãªã„ï¼‰ã€‚
- ãƒ­ã‚°ã¯æ—¢å®šã§æ°¸ç¶šåŒ–ã—ãªã„ã€‚ä¿å­˜ã™ã‚‹å ´åˆã¯ â€œè¨ºæ–­ãƒ¬ãƒãƒ¼ãƒˆâ€ ã¨ã—ã¦æ˜ç¤ºçš„ã« export ã—ã€strict 3DSS ã¨ã¯åˆ¥ç‰©ã¨ã—ã¦æ‰±ã†ã€‚

### 2.2.5.3 sidecar ã®æœ€å°ã‚¹ã‚±ãƒ«ãƒˆãƒ³ï¼ˆä¾‹ï¼‰

```json
{
  "sidecar_version": "0.1.0",
  "doc": { "document_uuid": "..." },
  "ui": {
    "outliner": { "columns": ["lock","name","pos","frames","uuid8"] },
    "layout": { "mode": "single-window" }
  },
  "authoring": {
    "locked_uuids": ["..."],
    "unknown_fields_by_uuid": { "...": { "raw": {} } }
  },
  "diagnostics": {
    "quickcheck": { "last_run_at": "2026-01-24T00:00:00Z", "issues": [] }
  }
}
```


## 2.3 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ¡ã‚¿ï¼ˆdocument_metaï¼‰

- modeler ã¯ `document_meta` ã® required ã‚’æº€ãŸã™ç·¨é›† UI ã‚’æä¾›ã™ã‚‹ã€‚
- ç”Ÿæˆæ™‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼š
  - `document_uuid` ã¯ UUIDv4 ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹
  - `schema_uri` ã¯æ—¢å®šã® release URIï¼ˆã‚¢ãƒ³ã‚«ãƒ¼ä»˜ãï¼‰ã‚’è‡ªå‹•è¨­å®šã™ã‚‹
  - `version` ã¯ `1.0.0` ã‚’åˆæœŸå€¤ã¨ã™ã‚‹ï¼ˆä»¥å¾Œã®é‹ç”¨ã¯åˆ¥è¦å®šï¼‰

## 2.4 è¦ç´ ã®è­˜åˆ¥ï¼ˆuuid / nameï¼‰

- æ°¸ç¶šè­˜åˆ¥å­ã¯ `meta.uuid` ã§ã‚ã‚‹ï¼ˆå‚ç…§ã® SSOTï¼‰ã€‚
- UI ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¡¨ç¤ºã¯ `name/caption` ã‚’å„ªå…ˆã—ã¦ã‚ˆã„ãŒã€uuid ã‚’å¸¸ã«å‚ç…§å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã€‚
- Outliner ã§ã¯ UUID ã‚’çŸ­ç¸®è¡¨ç¤ºã—ã¦ã‚ˆã„ï¼ˆä¾‹ï¼šå…ˆé ­ 8 æ¡ï¼‰ã€‚ã‚³ãƒ”ãƒ¼æ“ä½œã§ãƒ•ãƒ« UUID ã‚’å–å¾—ã§ãã‚‹ã“ã¨ã€‚

## 2.5 pointsï¼ˆå­˜åœ¨è¦ç´ ï¼‰

### 2.5.1 å¿…é ˆãƒ»æ¨å¥¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

- `meta.uuid`ï¼šå¿…é ˆ
- `appearance.position`ï¼šä½ç½®ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚ã‚Šï¼‰
- `appearance.marker.primitive`ï¼šå¿…é ˆ
- `appearance.marker.text` ã‚’æŒã¤å ´åˆï¼š
  - `content` ã¨ `pose` ãŒå¿…é ˆï¼ˆpose ã¯ front/up vec3ï¼‰

### 2.5.2 Outlinerï¼ˆpointsï¼‰ã®æœ€å°åˆ—

points ã® Outliner ã¯ã€Œä¿¯ç°ã€ã«å¾¹ã—ã€åˆ—ã¯æ¬¡ã‚’æœ€å°ã¨ã™ã‚‹ã€‚

- nameï¼ˆè¡¨ç¤ºåï¼‰
- positionï¼ˆx,y,zï¼‰
- textï¼ˆsize / pose / alignï¼‰â€»å¿…è¦ãªç¯„å›²ã®ã¿ï¼ˆåˆ—ã‚»ãƒƒãƒˆåˆ‡æ›¿ã‚’æ¨å¥¨ï¼‰
- uuidï¼ˆçŸ­ç¸®ï¼‰

è©³ç´°ï¼ˆmarkerã€è‰²ã€opacityã€tags ç­‰ï¼‰ã¯ PropertyPanel ã§æ‰±ã†ã€‚

## 2.6 linesï¼ˆé–¢ä¿‚è¦ç´ ï¼‰

### 2.6.1 endpointsï¼ˆend_a / end_bï¼‰

- endpoint ã¯ **ref / coord ã®ã„ãšã‚Œã‹**ã§ã‚ã‚Šã€ä¸¡æ–¹åŒæ™‚ã«ã¯æŒãŸãªã„ã€‚
- modeler ã¯æ¬¡ã‚’æä¾›ã™ã‚‹ã€‚
  - ref å‹ï¼šæ—¢å­˜ point ã® uuid ã‚’å‚ç…§ï¼ˆæ¨å¥¨ï¼‰
  - coord å‹ï¼šåº§æ¨™ç›´æ›¸ãï¼ˆè£œåŠ©ç·šç­‰ã«åˆ©ç”¨ï¼‰

### 2.6.2 caption ã¨ caption_text

- è¡¨ç¤ºæ–‡å­—åˆ—ã¯ `signification.caption`ï¼ˆlocalized_stringï¼‰ã§ã‚ã‚‹ã€‚
- è¡¨ç¤ºã‚¹ã‚¿ã‚¤ãƒ«ã¯ `appearance.caption_text`ï¼ˆsize / align / poseï¼‰ã§ã‚ã‚‹ï¼ˆ`content` ã¯ caption è¡¨ç¤ºã®ä¸Šæ›¸ãã¨ã—ã¦æ‰±ãˆã‚‹ï¼‰ã€‚
- `caption_text.pose` ã¯ text_poseï¼ˆfront/up vec3ï¼‰ã§ã‚ã‚Šã€modeler ã¯æ­£ç¢ºã«è¡¨ç¤ºã™ã‚‹ã€‚

### 2.6.3 Outlinerï¼ˆlinesï¼‰ã®æœ€å°åˆ—

- captionï¼ˆè¡¨ç¤ºåï¼‰
- end_a / end_bï¼ˆref ã¯çŸ­ç¸® uuidã€coord ã¯åº§æ¨™ï¼‰
- frames
- uuidï¼ˆçŸ­ç¸®ï¼‰

## 2.7 auxï¼ˆè£œåŠ©è¦ç´ ï¼‰

aux ã¯ points/lines ã¨ã¯åˆ¥æ ã®ã€Œè£œåŠ©è¦ç´ ã€ã§ã‚ã‚Šã€èƒŒæ™¯ãƒ»æ³¨é‡ˆãƒ»ã‚¬ã‚¤ãƒ‰ç­‰ã‚’è¡¨ã™ã€‚  
ã‚¹ã‚­ãƒ¼ãƒä¸Šã®ä¸­å¿ƒã¯ `aux[].appearance.module` ã§ã€**å˜ä¸€ã‚­ãƒ¼ã® objectï¼ˆone-ofï¼‰**ã¨ã—ã¦ module ç¨®åˆ¥ã‚’è¡¨ç¾ã™ã‚‹ã€‚

### 2.7.1 moduleï¼ˆone-ofï¼‰ã®è¡¨ç¾ï¼ˆstrictï¼‰

- `aux[].appearance.module` ã¯æ¬¡ã®ã„ãšã‚Œã‹ **1ã¤ã ã‘**ã‚’æŒã¤ï¼š
  - `grid` / `axis` / `plate` / `shell` / `hud` / `extension`
- ä¾‹ï¼š
  - `{ "grid": { "grid_type": "plane", "spacing": 10, "color": "#888" } }`
  - `{ "axis": { "length": 100 } }`
  - `{ "extension": { "type": "latex", "latex": { "content": "...", "pose": { "front":[0,1,0], "up":[0,0,1] } } } }`

> NOTEï¼ˆç¾è¡Œå®Ÿè£… / P0ï¼‰
> - UI ã§ã¯ module ã®ã€Œç¨®é¡ã‚­ãƒ¼é¸æŠã€ã¾ã§ã¯å¯¾å¿œï¼ˆ`uiPropertyController` ã® `/appearance/module` patchï¼‰ã€‚
> - module ã”ã¨ã®è©³ç´°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç·¨é›†ã¯ P1 ä»¥é™ï¼ˆç¾çŠ¶ã¯ç©º object `{}` ã‚’å…¥ã‚Œã¦æˆç«‹ã•ã›ã‚‹ï¼‰ã€‚

### 2.7.2 extension.latexï¼ˆschema ä¸Šã®æ‹¡å¼µï¼‰

- `aux[].appearance.module.extension` ã¯æ‹¡å¼µç‚¹ã¨ã—ã¦ `type` ã¨å„ payloadï¼ˆä¾‹ï¼š`latex`ï¼‰ã‚’æŒã¤ã€‚
- `latex` ã¯ schema ä¸Šã€å°‘ãªãã¨ã‚‚æ¬¡ãŒå¿…é ˆï¼š
  - `aux[].appearance.module.extension.latex.content`
  - `aux[].appearance.module.extension.latex.pose`ï¼ˆ`front/up` ã® vec3ï¼‰

> NOTEï¼ˆç¾è¡Œå®Ÿè£… / P0ï¼‰
> - `extension.latex` ã®ç·¨é›† UI ã¨æç”»ã¯æœªå¯¾å¿œï¼ˆpreview ã¯ placeholder è¡¨ç¤ºã®ã¿ï¼‰ã€‚
> - P1 ã§ renderer ã¨ Property ã‚’æ‹¡å¼µã—ã€viewer ã¨åŒç­‰ã®æç”»ã«å¯„ã›ã‚‹ã€‚

### 2.7.3 Outlinerï¼ˆauxï¼‰ã®æœ€å°åˆ—

- kindï¼ˆå›ºå®šï¼šauxï¼‰
- nameï¼ˆè¡¨ç¤ºåï¼‰
- moduleï¼ˆ`aux[].appearance.module` ã®ã‚­ãƒ¼ï¼‰
- positionï¼ˆx/y/z ã®ç°¡æ˜“è¡¨ç¤ºï¼‰
- framesï¼ˆè¨­å®šæœ‰ç„¡ã¨ç°¡æ˜“è¡¨ç¤ºï¼‰

â€» ä¾‹ï¼š`name=Grid`, `module=grid`, `pos=(0,0,0)`, `frames=*`ã€‚


## 2.8 framesï¼ˆæ™‚é–“å±¤ï¼‰ç·¨é›†

### 2.8.1 frames ã®å‹

frames ã¯æ¬¡ã®ã„ãšã‚Œã‹ã§ã‚ã‚‹ã€‚

- integerï¼ˆå˜ä¸€ãƒ•ãƒ¬ãƒ¼ãƒ ï¼‰
- integer[]ï¼ˆè¤‡æ•°ãƒ•ãƒ¬ãƒ¼ãƒ ã€é‡è¤‡ç„¡ã—ï¼‰

### 2.8.2 UI å…¥åŠ›ï¼ˆç¯„å›²ãƒ»å¼ï¼‰ã¨ strict å‹

- FramesEditor ã¯ã€å…¥åŠ›åˆ©ä¾¿ã®ãŸã‚ `1-10` ç­‰ã®ç¯„å›²è¡¨è¨˜ã‚’å—ã‘ã¦ã‚‚ã‚ˆã„ã€‚
- ãŸã ã—ã€ç¯„å›²è¡¨è¨˜ã¯ IR å†…ã§è§£æ±ºã—ã€Save/Export ã§ã¯ strict å‹ï¼ˆinteger ã¾ãŸã¯ integer[]ï¼‰ã¸å¤‰æ›ã™ã‚‹ã€‚

### 2.8.3 æ­£è¦åŒ–ï¼ˆæ¨å¥¨ï¼‰

Save/Export æ™‚ã« frames ã‚’æ­£è¦åŒ–ã™ã‚‹å ´åˆã€æ¬¡ã‚’æ¨å¥¨ã™ã‚‹ã€‚

- è¤‡æ•°å€¤ï¼šæ˜‡é †ã‚½ãƒ¼ãƒˆ + unique
- å˜ä¸€å€¤ï¼šinteger ã¨ã—ã¦å‡ºåŠ›
- æœªè¨­å®šï¼šframes ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è‡ªä½“ã‚’çœç•¥ï¼ˆå¸¸æ™‚è¡¨ç¤ºæ‰±ã„ï¼‰

## 2.9 text_poseï¼ˆfront/upï¼‰ã®è§£é‡ˆï¼ˆmodeler å´ï¼‰

### 2.9.1 å¯¾è±¡

modeler ã¯æ¬¡ã® pose ã‚’ã€viewer ã¨åŒç­‰ã«è§£é‡ˆã—ã¦æç”»ã™ã‚‹ã€‚

- points[].appearance.marker.text.pose
- lines[].appearance.caption_text.pose
- aux[].appearance.module.extension.latex.pose
- aux[].appearance.marker.text.pose (optional; marker.text ã‚’ä½¿ã†å ´åˆ)

### 2.9.2 æ•°å­¦çš„è¦ä»¶ï¼ˆç›´äº¤åŒ–ï¼‰

- `front` ã¨ `up` ã¯æ­£è¦åŒ–ã—ã€ç›´äº¤åŒ–ã—ã¦æç”»ã«ç”¨ã„ã‚‹ã€‚
- `front` ã¨ `up` ãŒå¹³è¡Œã«è¿‘ã„å ´åˆã¯ã€è¨ºæ–­ã‚’å‡ºã—ã€æç”»ã¯å®‰å…¨ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ç¶™ç¶šã—ã¦ã‚ˆã„ï¼ˆãŸã ã—å€¤ã¯è‡ªå‹•ä¿®æ­£ã—ã¦ä¿å­˜ã—ãªã„ï¼‰ã€‚


# 3 UIæ§‹æˆã¨æ“ä½œä½“ç³»ï¼ˆmodelerï¼‰

> NOTE: æœ¬ç« ä»¥é™ã¯ â€œã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒŠæœ€å°åˆ— + ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è©³ç´°ç·¨é›† + frames è¡¨â€ ã‚’åŸºæœ¬ã«è¨˜è¿°ã™ã‚‹ã€‚
> å®Ÿè£…ãŒå›ºã¾ã‚‹ã¾ã§ã€ç« ç«‹ã¦ã ã‘å…ˆã«å›ºå®šã—ã€å†…å®¹ã¯æ®µéšçš„ã«å……å¡«ã™ã‚‹ã€‚

## 3.1 ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆPCå‰æï¼‰

modeler ã¯ **PCï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼‹ãƒã‚¦ã‚¹ï¼‰å‰æ**ã¨ã—ã€ã‚¹ãƒãƒ›UIã¯å¯¾è±¡å¤–ã¨ã™ã‚‹ã€‚

### 3.1.1 æ—¢å®šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆå˜ä¸€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ï¼šP0ï¼‰

æ—¢å®šã¯ **å˜ä¸€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†…ã®åˆ†å‰²è¡¨ç¤º**ã¨ã™ã‚‹ã€‚

- å·¦ï¼šOutlinerï¼ˆã‚¹ãƒ—ã‚·ï¼‰
- ä¸­ï¼šPreviewï¼ˆWebGLï¼‰
- å³ï¼šPropertyPanelï¼ˆï¼‹FramesEditor ã¯ã‚¿ãƒ–/ä¸‹æ®µç­‰ï¼‰

### 3.1.2 ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®åˆ†é›¢ï¼ˆDetach Previewï¼šP1 ä»»æ„ï¼‰

ãƒãƒ«ãƒãƒ¢ãƒ‹ã‚¿ä½œæ¥­æ”¯æ´ã¨ã—ã¦ã€Preview ã‚’ **åˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«åˆ†é›¢**ã§ãã¦ã‚‚ã‚ˆã„ï¼ˆä»»æ„æ©Ÿèƒ½ï¼‰ã€‚

- ã€ŒDetach Previewã€ã§æ–°è¦ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ãã€Previewï¼ˆWebGLï¼‰ã‚’è¡¨ç¤ºã™ã‚‹
- Coreï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆçŠ¶æ…‹ï¼‰ã¯å˜ä¸€ï¼ˆsingle-writerï¼‰ã‚’ç¶­æŒã—ã€è¤‡æ•°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é–“ã¯ hub ã‚’ä»‹ã—ã¦åŒæœŸã™ã‚‹
- åˆ†é›¢æ™‚ã‚‚ Outliner/Property ã¯ãƒ¡ã‚¤ãƒ³ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«æ®‹ã™ï¼ˆç·¨é›†SSOTã®æ•£é€¸ã‚’é˜²ãï¼‰

â€»å®Ÿè£…ä¸Šã€WebGL ã‚­ãƒ£ãƒ³ãƒã‚¹ã®â€œç§»å‹•â€ã§ã¯ãªãã€åˆ†é›¢å…ˆã§ renderer ã‚’å†ç”Ÿæˆã—ã€core ã® snapshot ã‚’è³¼èª­ã—ã¦æç”»ã™ã‚‹æ–¹å¼ã‚’æ¨å¥¨ã™ã‚‹ã€‚

**ã‚¹ã‚³ãƒ¼ãƒ—æ±ºå®š**ï¼šP0 ã¯ 3.1.1 ã®å˜ä¸€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ï¼ˆ3ãƒšã‚¤ãƒ³ï¼‰ã‚’å¿…é ˆã¨ã—ã€Detach Preview ã¯ P1ï¼ˆä»»æ„æ©Ÿèƒ½ï¼‰ã¨ã—ã¦å¾Œç¶šãƒ•ã‚§ãƒ¼ã‚ºã§æ¤œè¨ã™ã‚‹ã€‚

## 3.2 Outlinerï¼ˆpoints / lines / aux / framesï¼‰
## 3.3 PropertyPanelï¼ˆå…±é€š/ç¨®åˆ¥åˆ¥ï¼‰
## 3.4 é¸æŠï¼ˆå˜ä½“/è¤‡æ•°/ç¯„å›²ï¼‰ã¨ãƒ•ã‚£ãƒ«ã‚¿
## 3.5 å¤‰å½¢ï¼ˆMove/Rotate/Scaleï¼‰ã¨æ•°å€¤å…¥åŠ›
## 3.6 ã‚¹ãƒŠãƒƒãƒ—ï¼ˆOSNAP / ã‚°ãƒªãƒƒãƒ‰ / è»¸ãƒ­ãƒƒã‚¯ï¼‰
## 3.7 Undo/Redo ã¨ã‚³ãƒãƒ³ãƒ‰å±¥æ­´ UI
## 3.8 ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼ˆã‚­ãƒ¼ãƒãƒƒãƒ—ï¼‰

## 3.9 lockï¼ˆè¦ç´ ãƒ­ãƒƒã‚¯ï¼‰ã¨èª¤æ“ä½œé˜²æ­¢

### 3.9.1 ç›®çš„

- GUI èª¤æ“ä½œã«ã‚ˆã‚‹æ„å›³ã—ãªã„ç§»å‹•ãƒ»ç·¨é›†ã‚’é˜²æ­¢ã™ã‚‹ã€‚
- â€œç·¨é›†å¯¾è±¡ã‹ã‚‰å¤–ã™â€ ã“ã¨ã«ã‚ˆã‚Šã€ä½œæ¥­ä¸­ã®ãƒ¢ãƒ‡ãƒ«åŸºæº–ï¼ˆå›ºå®šéƒ¨åˆ†ï¼‰ã‚’å®ˆã‚‹ã€‚

### 3.9.2 lock ã®ç²’åº¦ï¼ˆLevel 1ï¼‰

- lock ã¯ **è¦ç´ å˜ä½**ï¼ˆpoint/line/auxï¼‰ã€‚
- éƒ¨åˆ†ãƒ­ãƒƒã‚¯ï¼ˆposition ã ã‘ç­‰ï¼‰ã¯è¡Œã‚ãªã„ï¼ˆLevel 2 ã¯éæ¡ç”¨ï¼‰ã€‚

### 3.9.3 lock ã®åŠ¹æœï¼ˆç¦æ­¢æ“ä½œï¼‰

lock è¦ç´ ã«å¯¾ã—ã¦ã€modeler ã¯æ¬¡ã®æ“ä½œã‚’æ‹’å¦ã™ã‚‹ã€‚

- Transformï¼ˆMove / Rotate / Scaleï¼‰
- Delete
- PropertyPanel ã® Saveï¼ˆé–²è¦§ã¯å¯ï¼‰
- Line ã‚¨ãƒ‡ã‚£ã‚¿ï¼ˆAdvancedï¼‰ã® Apply

æ‹’å¦æ™‚ã¯ QuickCheck/Toast ç­‰ã§ç†ç”±ã‚’æç¤ºã™ã‚‹ï¼ˆä¾‹ï¼šã€Œlocked: uuid=...ã€ï¼‰ã€‚

### 3.9.4 lock ã®UIå°ç·š

- Outlinerï¼š
  - **å·¦ç«¯åˆ—**ã« lock ãƒˆã‚°ãƒ«ï¼ˆğŸ”’ï¼‰ã‚’ç½®ãï¼ˆæœ€çŸ­å°ç·šï¼‰
  - lock=ON ã®è¡Œã¯ **è¡Œå…¨ä½“ã‚’ã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆ**ã—ã¦çŠ¶æ…‹ã‚’æ˜ç¢ºåŒ–ã™ã‚‹
- Previewï¼š
  - lock è¦ç´ ã‚‚ pick ã¯å¯èƒ½ï¼ˆå‚ç…§ãƒ»é¸æŠãƒ»ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã®ãŸã‚ï¼‰
  - ãŸã ã— Transformï¼ˆMove/Rotate/Scaleï¼‰é–‹å§‹æ™‚ã« lock åˆ¤å®šã‚’è¡Œã„ã€lock è¦ç´ ã¯é™¤å¤–ã¾ãŸã¯æ“ä½œæ‹’å¦ã™ã‚‹
- PropertyPanelï¼š
  - lock ã®åˆ‡æ›¿ï¼ˆReadOnly è¡¨ç¤ºã§ã‚‚ã‚ˆã„ï¼‰
  - lock ä¸­ã¯ Save ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹

### 3.9.5 æ°¸ç¶šåŒ–

- lock çŠ¶æ…‹ã¯ UI çŠ¶æ…‹ã¨ã—ã¦æ‰±ã„ã€å¿…è¦ã«å¿œã˜ã¦ sidecar ã«ä¿å­˜ã™ã‚‹ï¼ˆ3DSS ã¸æ··å…¥ã•ã›ãªã„ï¼‰ã€‚



## 3.10 QuickCheck ãƒ‘ãƒãƒ«ï¼ˆä¿å­˜å¤±æ•—æ™‚ã®å°ç·šï¼‰

- QuickCheck ãƒ‘ãƒãƒ«ã¯å¸¸è¨­ï¼ˆãƒ‰ãƒƒã‚¯ï¼‰ã¾ãŸã¯ Save/Export ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å†…ã«è¡¨ç¤ºã•ã‚Œã‚‹ã€‚
- æ—¢å®šã¯ `error` ã‚’å¼·èª¿ã—ã€`warn` ã¯æŠ˜ã‚ŠãŸãŸã¿ã§ã‚ˆã„ã€‚
- ä¸€è¦§â†’ã‚¯ãƒªãƒƒã‚¯ï¼ˆã¾ãŸã¯ Enterï¼‰ã§ Outliner/Property ã¸ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ï¼ˆ2.2.3.2 / 6.2 å‚ç…§ï¼‰ã€‚
- â€œä¿®æ­£â†’å†ãƒã‚§ãƒƒã‚¯â€ ã®ãƒ«ãƒ¼ãƒ—ãŒé€”åˆ‡ã‚Œãªã„ã“ã¨ã‚’é‡è¦–ã™ã‚‹ï¼ˆé–‰ã˜ã¦ã‚‚ä½œæ¥­ã¯ç¶™ç¶šã€å†è¡¨ç¤ºå¯èƒ½ï¼‰ã€‚


## 3.11 Transformï¼ˆP0ï¼šMove/Rotate/Scaleï¼‰ã¨ãƒ¢ãƒ¼ãƒ‰é·ç§»

æœ¬ç¯€ã¯ modeler ã®æœ€å°ç·¨é›†æ©Ÿèƒ½ã¨ã—ã¦ã€è¤‡æ•°é¸æŠã‚’å«ã‚€ Transform æ“ä½œï¼ˆMove/Rotate/Scaleï¼‰ã‚’å®šç¾©ã™ã‚‹ã€‚

### 3.11.1 å‰æï¼ˆè¤‡æ•°é¸æŠï¼‰

- é¸æŠã¯ Previewï¼ˆãƒ”ãƒƒã‚¯ï¼‰ãŠã‚ˆã³ Outlinerï¼ˆè¤‡æ•°è¡Œé¸æŠï¼‰ã‹ã‚‰è¡Œãˆã‚‹ã€‚
- é¸æŠã¯ **è¤‡æ•°è¦ç´ **ï¼ˆpoint/line/auxï¼‰ã‚’è¨±å®¹ã™ã‚‹ã€‚
- lock è¦ç´ ã¯é¸æŠå¯èƒ½ã ãŒã€Transform å¯¾è±¡ã‹ã‚‰ã¯é™¤å¤–ã¾ãŸã¯æ“ä½œæ‹’å¦ã™ã‚‹ï¼ˆ3.9 å‚ç…§ï¼‰ã€‚

### 3.11.2 ãƒ¢ãƒ¼ãƒ‰ï¼ˆP0ï¼‰

- `Select`ï¼ˆé€šå¸¸ï¼‰
- `Move`
- `Rotate`
- `Scale`

### 3.11.3 ã‚­ãƒ¼ãƒãƒƒãƒ—ï¼ˆP0 å›ºå®šï¼‰

- `M`ï¼šMove ãƒ¢ãƒ¼ãƒ‰ã¸
- `R`ï¼šRotate ãƒ¢ãƒ¼ãƒ‰ã¸
- `S`ï¼šScale ãƒ¢ãƒ¼ãƒ‰ã¸
- `Enter`ï¼šç¢ºå®šï¼ˆcommitï¼‰
- `Esc`ï¼šã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼ˆSelect ã«æˆ»ã‚‹ã€å¤‰æ›´ã¯åæ˜ ã—ãªã„ï¼‰
- `X / Y / Z`ï¼šè»¸ãƒ­ãƒƒã‚¯åˆ‡æ›¿ï¼ˆæŠ¼ä¸‹ã§è©²å½“è»¸ã«æ‹˜æŸã€å†æŠ¼ä¸‹ã§è§£é™¤ï¼‰

â€» `M/R/S` ã¯ãƒˆã‚°ãƒ«ã§ã¯ãªãã€Œè©²å½“ãƒ¢ãƒ¼ãƒ‰ã¸é·ç§»ã€ã¨ã™ã‚‹ã€‚

### 3.11.4 æ“ä½œï¼ˆPreviewï¼‰

- Transform ã¯ **ãƒ¢ãƒ¼ãƒ‰ä¸­ã®ã¿**ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œã§ç™ºå‹•ã™ã‚‹ï¼ˆSelect ãƒ¢ãƒ¼ãƒ‰ã§ã®ãƒ‰ãƒ©ãƒƒã‚°ã¯ç§»å‹•ã—ãªã„ï¼‰ã€‚
- ä½œæ¥­å¹³é¢ï¼ˆwork planeï¼‰ã¯ P0 ã§ã¯æ¬¡ã®ã„ãšã‚Œã‹ã«å›ºå®šã—ã€å®Ÿè£…éƒ½åˆã§ã‚ˆã„ï¼š
  - `camera-plane`ï¼ˆã‚«ãƒ¡ãƒ©å¹³é¢ï¼‰
  - `world-XY`ï¼ˆãƒ¯ãƒ¼ãƒ«ãƒ‰XYå¹³é¢ï¼‰
- è»¸ãƒ­ãƒƒã‚¯ï¼ˆX/Y/Zï¼‰ãŒæœ‰åŠ¹ãªå ´åˆã€ãƒ‰ãƒ©ãƒƒã‚°ã¯è©²å½“è»¸æ–¹å‘ã«æ‹˜æŸã•ã‚Œã‚‹ã€‚

### 3.11.5 ã‚³ãƒŸãƒƒãƒˆç²’åº¦ï¼ˆUndo/Redo ã®ãŸã‚ã®å›ºå®šï¼‰

- Transform ã¯ **1å›ã®ç¢ºå®šï¼ˆEnterï¼‰= 1ã‚³ãƒãƒ³ãƒ‰**ã¨ã—ã¦ CommandManager ã«è¨˜éŒ²ã™ã‚‹ã€‚
- ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°ã‚’è¡Œã£ã¦ã‚ˆã„ãŒã€**ç¢ºå®šã¾ã§ã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆçŠ¶æ…‹ã‚’ç¢ºå®šã•ã›ãªã„**ï¼ˆãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ‰±ã„ï¼‰ã€‚
- `Esc` ã¯ãƒ‰ãƒ©ãƒƒã‚°ä¸­/çµ‚äº†å¾Œã‚’å•ã‚ãšã€æœªç¢ºå®šã®å¤‰æ›´ã‚’ç ´æ£„ã™ã‚‹ã€‚

### 3.11.6 æ•°å€¤å…¥åŠ›ï¼ˆP1 ä»¥é™ï¼‰

P0 ã§ã¯ãƒ‰ãƒ©ãƒƒã‚°ã«ã‚ˆã‚‹æ“ä½œã‚’ä¸»ã¨ã—ã€æ•°å€¤å…¥åŠ›ï¼ˆÎ”x/Î”y/Î”z ç­‰ï¼‰ã¯ P1 ä»¥é™ã®æ‹¡å¼µã¨ã—ã¦æ‰±ã†ã€‚


# 4 ä¸‰æ¬¡å…ƒæç”»ã¨ã‚«ãƒ¡ãƒ©ï¼ˆmodelerï¼‰

## 4.1 ã‚·ãƒ¼ãƒ³æ§‹æˆï¼ˆgrid/axis/selection/gizmoï¼‰
## 4.2 ãƒ”ãƒƒã‚­ãƒ³ã‚°ï¼ˆraycastï¼‰ã¨å„ªå…ˆé †ä½

- lock è¦ç´ ã¯ pick å¯èƒ½ã¨ã™ã‚‹ï¼ˆå‚ç…§ãƒ»ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ»ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£é–²è¦§ã®ãŸã‚ï¼‰ã€‚
- ãŸã ã— pick ã‹ã‚‰ç›´æ¥ Transform ã¸é·ç§»ã™ã‚‹å ´åˆã¯ lock åˆ¤å®šã‚’è¡Œã†ï¼ˆ3.9 å‚ç…§ï¼‰ã€‚

## 4.3 å¤‰å½¢æ“ä½œï¼ˆMove/Rotate/Scaleï¼‰ã¨ä½œæ¥­å¹³é¢
- modeler ã¯ viewer ã®å³ä¸‹æ–¹ä½ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆç­‰ã® â€œé‘‘è³UIâ€ ã‚’æŒãŸãªã„ï¼ˆ0.4 å‚ç…§ï¼‰ã€‚
- Transform ã®ãŸã‚ã®å¸¸è¨­ã‚ªãƒ³ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ gizmoï¼ˆãƒãƒ³ãƒ‰ãƒ«ï¼‰ã¯ P0 ã§ã¯å¿…é ˆã¨ã—ãªã„ã€‚ãƒ¢ãƒ¼ãƒ‰ä¸­ã®ãƒ‰ãƒ©ãƒƒã‚°ï¼‹è»¸ãƒ­ãƒƒã‚¯ã§æˆç«‹ã•ã›ã‚‹ã€‚
- ä½œæ¥­å¹³é¢ï¼ˆwork planeï¼‰ã¨è»¸ãƒ­ãƒƒã‚¯ã®è§£é‡ˆã¯ 3.11 ã¨ä¸€è‡´ã•ã›ã‚‹ã€‚

## 4.4 ãƒ†ã‚­ã‚¹ãƒˆæç”»ï¼ˆpose / align / sizeï¼‰
## 4.5 ã‚«ãƒ¡ãƒ©ï¼ˆorbit / fit / resetï¼‰
## 4.6 ãƒ•ãƒ¬ãƒ¼ãƒ å†ç”Ÿãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆframes ã®é©ç”¨ï¼‰


# 5 UIã‚¤ãƒ™ãƒ³ãƒˆã¨çŠ¶æ…‹ç®¡ç†ï¼ˆmodelerï¼‰

## 5.1 çŠ¶æ…‹æ©Ÿæ¢°ï¼ˆmodeï¼‰
## 5.2 å…¥åŠ›ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆmouse/touch/keyboardï¼‰
## 5.3 single-writer ã¨ã‚³ãƒãƒ³ãƒ‰å¢ƒç•Œ
- CommandManager ã¯ apply å‰ã«å¯¾è±¡è¦ç´ ã® lock ã‚’æ¤œæŸ»ã—ã€ç¦æ­¢æ“ä½œã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã€‚
- å¤‰å½¢ä¸­ï¼ˆãƒ‰ãƒ©ãƒƒã‚°ä¸­ï¼‰ã¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°ã‚’è¡Œã£ã¦ã‚ˆã„ãŒã€ã‚³ãƒŸãƒƒãƒˆæ™‚ã« lock ã‚’å†æ¤œæŸ»ã™ã‚‹ã€‚
- Transformï¼ˆMove/Rotate/Scaleï¼‰ã¯ â€œãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³â€ ã¨ã—ã¦æ‰±ã„ã€`commit()`ï¼ˆEnterï¼‰ã§ 1ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦ç¢ºå®šã™ã‚‹ã€‚
- ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã«ç”Ÿæˆã•ã‚Œã‚‹ä¸­é–“çŠ¶æ…‹ã¯ IR/UI çŠ¶æ…‹ã«ç•™ã‚ã€commit å‰ã« strict 3DSS ã¸åæ˜ ã—ãªã„ã€‚
- `cancel()`ï¼ˆEscï¼‰æ™‚ã¯ä¸­é–“çŠ¶æ…‹ã‚’ç ´æ£„ã—ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆçŠ¶æ…‹ã‚’å¤‰æ›´ã—ãªã„ã€‚

## 5.4 ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç·¨é›†æ™‚ã®å³æ™‚è¨ºæ–­ï¼‰
## 5.5 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼ˆå¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿æ™‚ï¼‰


# 6 ãƒ­ã‚°ãƒ»è¨ºæ–­ãƒ»å¤–éƒ¨é€£æºã¨ç¦æ­¢æ©Ÿèƒ½ï¼ˆmodelerï¼‰

## 6.1 ãƒ­ã‚°ã‚«ãƒ†ã‚´ãƒªï¼ˆBOOT/DOC/EDIT/VALIDATE/IOï¼‰
## 6.2 Quick Check ã®å‡ºåŠ›ã¨ UI è¡¨ç¤º
QuickCheck ã¯ Importï¼ˆpermissiveï¼‰ãŠã‚ˆã³ç·¨é›†ä¸­ã«ç™ºç”Ÿã™ã‚‹å•é¡Œã‚’ **è¨ºæ–­ï¼ˆdiagnosticï¼‰**ã¨ã—ã¦åé›†ã—ã€UI ã¨ãƒ­ã‚°ã¸æç¤ºã™ã‚‹ã€‚  
QuickCheck è‡ªä½“ã¯ 3DSS ã®å¥‘ç´„ã§ã¯ãªãã€**ç·¨é›†æ”¯æ´ã®ãŸã‚ã®è¨ºæ–­ãƒ¬ã‚¤ãƒ¤**ã§ã‚ã‚‹ã€‚

### 6.2.1 severityï¼ˆé‡å¤§åº¦ï¼‰

- `error`ï¼šæœªè§£æ±ºã®ã¾ã¾ Save/Exportï¼ˆstrictï¼‰ã¸é€²ã‚€ã“ã¨ã‚’è¨±ã•ãªã„ï¼ˆãƒ–ãƒ­ãƒƒã‚¯å¯¾è±¡ï¼‰
- `warn`ï¼šç¶™ç¶šå¯èƒ½ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼æ³¨æ„ï¼ˆè‡ªå‹•æ­£è¦åŒ–ãƒ»æ—§è¡¨è¨˜ãƒ»æ¨å¥¨é•åç­‰ã‚’å«ã‚€ï¼‰
- `info`ï¼šå‚è€ƒæƒ…å ±ï¼ˆä»»æ„ï¼‰

â€» `error`/`warn` ã®å¢ƒç•Œã¯ 2.2.3ï¼ˆå‡ºå£ãƒ–ãƒ­ãƒƒã‚¯æ¡ä»¶ï¼‰ã¨æ•´åˆã™ã‚‹ã“ã¨ã€‚

### 6.2.2 å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆpayloadï¼‰

QuickCheck ã® 1ä»¶ï¼ˆIssueï¼‰ã¯æ¬¡ã® payload ã‚’æŒã¤ã€‚  
**å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**ã‚’å›ºå®šã—ã€UI ã¯ã“ã® payload ã‹ã‚‰ã€ŒåŸå› ä¸€è¦§ã€ã€Œã‚¸ãƒ£ãƒ³ãƒ—å°ç·šã€ã‚’æ§‹æˆã™ã‚‹ã€‚

#### å¿…é ˆ

- `severity`ï¼š`"error" | "warn" | "info"`
- `code`ï¼šæ©Ÿæ¢°å¯èª­ãªè­˜åˆ¥å­ï¼ˆä¾‹ï¼š`REF_MISSING_TARGET` / `UUID_DUPLICATE`ï¼‰
- `uuid`ï¼šå¯¾è±¡è¦ç´ ã® `meta.uuid`ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå…¨ä½“ã®å•é¡Œã¯ `null` ã‚’è¨±å®¹ã™ã‚‹
- `kind`ï¼š`"document" | "point" | "line" | "aux" | "unknown"`
- `path`ï¼šå¯¾è±¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã® JSON Pointerï¼ˆè¦ç´ ãƒ«ãƒ¼ãƒˆã‹ã‚‰ã®ç›¸å¯¾ï¼‰ã€‚ä¾‹ï¼š`"/appearance/marker/text/pose"`
- `expected`ï¼šæœŸå¾…ã™ã‚‹æ¡ä»¶ï¼ˆæ–‡å­—åˆ—ã¾ãŸã¯å°ã•ãª JSON å€¤ï¼‰
- `actual`ï¼šå®Ÿéš›ã®å€¤ï¼ˆæ–‡å­—åˆ—ã¾ãŸã¯å°ã•ãª JSON å€¤ï¼‰
- `message`ï¼šäººé–“å‘ã‘èª¬æ˜ï¼ˆ1è¡Œï¼‰

#### ä»»æ„ï¼ˆæ¨å¥¨ï¼‰

- `hint`ï¼šä¿®æ­£ã®æŒ‡é‡ï¼ˆUI ãŒã€Œä¿®æ­£æ¡ˆã€ã¨ã—ã¦è¡¨ç¤ºã§ãã‚‹çŸ­æ–‡ï¼‰
- `source`ï¼š`"import" | "normalize" | "edit" | "validate"`
- `can_autofix`ï¼š`boolean`ï¼ˆtrue ã®å ´åˆã§ã‚‚ â€œè‡ªå‹•ã§å®Ÿè¡Œã™ã‚‹â€ ã¨ã¯é™ã‚‰ãªã„ï¼‰
- `autofix_applied`ï¼š`boolean`ï¼ˆA/B ã®è‡ªå‹•è£œå®Œãƒ»æ­£è¦åŒ–ã‚’å®Ÿæ–½ã—ãŸå ´åˆ trueï¼‰
- `related_uuids`ï¼šå‚ç…§ä¸æ•´åˆç­‰ã§é–¢ä¿‚ã™ã‚‹ uuid ç¾¤ï¼ˆä¾‹ï¼šå‚ç…§å…ˆå€™è£œï¼‰
- `ts`ï¼šISO 8601ï¼ˆä»»æ„ã€ãƒ­ã‚°ç”¨é€”ï¼‰

#### path ã®ãƒ«ãƒ¼ãƒ«

- `path` ã¯ **è¦ç´ ãƒ«ãƒ¼ãƒˆã‹ã‚‰ã®ç›¸å¯¾ JSON Pointer**ã¨ã™ã‚‹ï¼ˆé…åˆ— index ã«ä¾å­˜ã—ãªã„ãŸã‚ï¼‰ã€‚
- UI ã¯ `uuid` ã§è¦ç´ ã‚’ç‰¹å®šã—ã€`path` ã§è©²å½“ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¸ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã€‚
- `uuid=null` ã®å ´åˆï¼ˆdocumentå•é¡Œï¼‰ã¯ `kind="document"` ã¨ã—ã€`path` ã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ«ãƒ¼ãƒˆç›¸å¯¾ã¨ã™ã‚‹ï¼ˆä¾‹ï¼š`"/document_meta"`ï¼‰ã€‚

### 6.2.3 è¡¨ç¤ºï¼ˆUIï¼‰è¦ä»¶

- QuickCheck ãƒ‘ãƒãƒ«ï¼ˆã¾ãŸã¯ Save/Export ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å†…ï¼‰ã« **ä¸€è¦§**ã‚’è¡¨ç¤ºã™ã‚‹ï¼ˆseverity ã§ãƒ•ã‚£ãƒ«ã‚¿å¯èƒ½ï¼‰ã€‚
- 1è¡Œã‚¯ãƒªãƒƒã‚¯ã§ `focusByIssue(issue)` ã‚’å‘¼ã³ã€è©²å½“è¦ç´ ã¸ã‚¸ãƒ£ãƒ³ãƒ—ã™ã‚‹ï¼ˆOutliner ã§é¸æŠï¼‹PropertyPanel ã‚’é–‹ãï¼‹`path` ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰ã€‚
- `error` ãŒ 1ä»¶ã§ã‚‚æ®‹ã‚‹å ´åˆã€Save/Export ã¯ãƒ–ãƒ­ãƒƒã‚¯ã—ã€ãƒ–ãƒ­ãƒƒã‚¯ç†ç”±ã¨ã—ã¦ QuickCheck ã‚’æç¤ºã™ã‚‹ã€‚
- ä¸€è¦§ã®æ“ä½œæ€§ï¼ˆä»»æ„ã ãŒæ¨å¥¨ï¼‰ï¼š
  - `â†‘/â†“`ï¼šè¡Œç§»å‹•
  - `Enter`ï¼šãƒ•ã‚©ãƒ¼ã‚«ã‚¹é·ç§»ï¼ˆã‚¯ãƒªãƒƒã‚¯åŒç­‰ï¼‰
  - `Esc`ï¼šä¸€è¦§ã‚’é–‰ã˜ã‚‹ï¼ˆä¿®æ­£ä½œæ¥­ã¯ç¶™ç¶šï¼‰



### 6.2.4 ä¾‹ï¼ˆJSONï¼‰

```json
{
  "severity": "error",
  "code": "REF_MISSING_TARGET",
  "uuid": "c0a8012e-2e1c-4c1f-9f24-1c1d9f86a111",
  "kind": "line",
  "path": "/end_a/ref",
  "expected": "ref points to existing point uuid",
  "actual": "8c2a... (missing)",
  "message": "end_a.ref points to a missing point uuid",
  "hint": "Pick an existing point for end_a, or switch endpoint to coord",
  "source": "import",
  "can_autofix": false,
  "autofix_applied": false
}
```


## 6.3 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆä¾‹å¤–ç¦æ­¢ã¨ no-opï¼‰
## 6.4 å¤–éƒ¨é€£æºï¼ˆç¦æ­¢ï¼šè¿½è·¡/è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰


# 7 æ‹¡å¼µãƒ»äº’æ›æ€§ï¼ˆmodelerï¼‰

## 7.1 schema_uri ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½å¾“
## 7.2 sidecar ã®äº’æ›æ€§æ–¹é‡ï¼ˆmodeler å†…é™å®šï¼‰
## 7.3 å°†æ¥æ‹¡å¼µï¼ˆconstraints / blocks / collaborationï¼‰


# 99 ä»•æ§˜â†’å®Ÿè£…å¯¾å¿œè¡¨ï¼ˆç« åˆ¥ï¼‰

ã“ã®ç« ã¯ **ä»•æ§˜ï¼ˆæœ¬ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰â†’ å®Ÿè£…ï¼ˆapps/modeler/ssotï¼‰** ã®å‚ç…§å¯¾å¿œã‚’ã€Œç« ã”ã¨ã€ã«æ•´ç†ã™ã‚‹ã€‚<br>å‚ç…§ã¯åŸå‰‡ SSOT å´ï¼ˆ`apps/modeler/ssot/**`ï¼‰ã‚’ç¤ºã—ã€`apps/site/public/**` ç­‰ã®ãƒŸãƒ©ãƒ¼ã¯å¯¾è±¡å¤–ã¨ã™ã‚‹ã€‚

## 0ç« 

| ä»•æ§˜ç¯€ | è¦ç‚¹ | å®Ÿè£…å‚ç…§ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«/é–¢æ•°ï¼‰ | çŠ¶æ³ |
|---|---|---|---|
| 0.1 | modeler ã®å½¹å‰² | apps/modeler/ssot/index.html (UI shell)<br>apps/modeler/ssot/modelerHostBoot.js (entry)<br>apps/modeler/ssot/runtime/bootstrapModeler.js:bootstrapModeler | PARTIAL |
| 0.2 | common / schema ä»•æ§˜ã¨ã®é–¢ä¿‚ï¼ˆã‚¹ã‚­ãƒ¼ãƒãŒå¥‘ç´„ SSOTï¼‰ | packages/schemas/3DSS.schema.json (å¥‘ç´„)<br>apps/modeler/ssot/runtime/core/coreControllers.js:validator.validateStrict / importNormalize | DONE |
| 0.3 | é©ç”¨ç¯„å›² | apps/modeler/ssot/ui/controllers/uiFileController.js (New/Open/Save/Export)<br>apps/modeler/ssot/ui/controllers/uiPropertyController.js (ç·¨é›†)<br>apps/modeler/ssot/ui/controllers/uiOutlinerController.js (è¿½åŠ /å‰Šé™¤)<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js (preview) | PARTIAL |
| 0.4 | éå¯¾è±¡ï¼ˆæœ¬ä»•æ§˜ã®ç¯„å›²å¤–ï¼‰ | â€” (ã‚ªãƒ³ãƒ©ã‚¤ãƒ³åŒæœŸ/å”èª¿ç·¨é›†ãªã©ã¯æœªå®Ÿè£…) | TODO |
| 0.5 | è¨­è¨ˆæ–¹é‡ï¼ˆç·¨é›†ã‚¢ãƒ—ãƒªã¨ã—ã¦ï¼‰ | apps/modeler/ssot/runtime/core/coreControllers.js (single-writer + undo/redo)<br>apps/modeler/ssot/ui/controllers/uiPropertyController.js (æœªé©ç”¨dirty) | PARTIAL |
| 0.6 | ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼šãƒ¬ã‚¤ãƒ¤ã¨è²¬å‹™ï¼šãƒ¬ã‚¤ãƒ¤ã¨è²¬å‹™ | apps/modeler/ssot/runtime/bootstrapModeler.js (entry)<br>apps/modeler/ssot/runtime/modelerHub.js (hub)<br>apps/modeler/ssot/runtime/core/coreControllers.js (core)<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js (renderer)<br>apps/modeler/ssot/ui/attachUiShell.js (ui) | DONE |
| 0.7 | ä¾å­˜æ³¨å…¥ï¼ˆDIï¼‰ã¨ composition root | apps/modeler/ssot/modelerHost.js:mountModelerHost (composition root)<br>apps/modeler/ssot/ui/attachUiShell.js (DOMåé›†+controllerç”Ÿæˆ)<br>apps/modeler/ssot/ui/hubOps.js:startHub (hubç”Ÿæˆ) | DONE |
| 0.8 | ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ï¼ˆstart/stop/disposeï¼‰ | apps/modeler/ssot/runtime/modelerHub.js:createModelerHub (start/stop/resize/dispose)<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js:createRenderer (start/stop/dispose) | DONE |
| 0.9 | çŠ¶æ…‹æ‰€æœ‰æ¨©ï¼ˆsingle-writerï¼‰ | apps/modeler/ssot/runtime/core/coreControllers.js:edit (history group) + document.updateDocument<br>apps/modeler/ssot/ui/controllers/uiPropertyController.js (buffer->apply) | PARTIAL |

## 1ç« 

| ä»•æ§˜ç¯€ | è¦ç‚¹ | å®Ÿè£…å‚ç…§ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«/é–¢æ•°ï¼‰ | çŠ¶æ³ |
|---|---|---|---|
| 1.1 | ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ | apps/modeler/ssot/{index.html,modelerHost.js,modelerHostBoot.js,preview_out.html,previewOutBoot.js}<br>apps/modeler/ssot/runtime/**<br>apps/modeler/ssot/ui/** | DONE |
| 1.2 | Coreï¼ˆeditable state ã¨ç·¨é›†ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼‰ | apps/modeler/ssot/runtime/core/coreControllers.js:createCoreControllers<br>apps/modeler/ssot/runtime/core/coreFacade.js (compat)<br>apps/modeler/ssot/runtime/core/validation.js (AJVãƒ©ãƒƒãƒ‘) | DONE |
| 1.3 | ä¾å­˜é–¢ä¿‚ï¼ˆcore ä¸»å°ï¼‰ | apps/modeler/ssot/manifest.yaml (ports)<br>apps/modeler/ssot/ui/hubFacade.js (ui<->hub core surface)<br>apps/modeler/ssot/runtime/modelerHub.js (hubå†…DI) | DONE |
| 1.4 | å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è²¬å‹™ | apps/modeler/ssot/modelerHost.js:mountModelerHost<br>apps/modeler/ssot/runtime/bootstrapModeler.js<br>apps/modeler/ssot/runtime/modelerHub.js<br>apps/modeler/ssot/runtime/core/coreControllers.js<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js<br>apps/modeler/ssot/ui/attachUiShell.js + ui/controllers/* | DONE |
| 1.5 | I/Oï¼ˆmodeler æ¦‚è¦ï¼‰ | apps/modeler/ssot/ui/controllers/uiFileController.js<br>apps/modeler/ssot/runtime/core/coreControllers.js:file (open/save/export)<br>apps/modeler/ssot/runtime/bootstrapModeler.js:bootstrapModelerFromUrl | PARTIAL |
| 1.6 | ç¦æ­¢äº‹é …ï¼ˆmodeler å…¨ä½“ï¼‰ | apps/modeler/ssot/manifest.yaml:dependency_rules + checks<br>apps/modeler/ssot/scripts/check-forbidden-imports.mjs<br>apps/modeler/ssot/scripts/check-single-writer.mjs | DONE |
| 1.7 | èµ·å‹•ãƒ•ãƒ­ãƒ¼ | apps/modeler/ssot/modelerHostBoot.js (boot)<br>apps/modeler/ssot/modelerHost.js:mountModelerHost<br>apps/modeler/ssot/runtime/bootstrapModeler.js:bootstrapModeler | DONE |
| 1.8 | dev modeler ã¨æœ¬ç•ª modeler | apps/site/scripts/sync/modeler.mjs (SSOT->public mirror)<br>apps/modeler/ssot/manifest.yaml:paths | PARTIAL |
| 1.9 | baseline èµ·å‹•æ™‚ã®å›ºå®šæ¡ä»¶ | â€” (coordinate_system/units ã®å›ºå®šãƒ»ãƒã‚§ãƒƒã‚¯ã¯æœªå®Ÿè£…) | TODO |
| 1.10 | Preview Outï¼ˆäºŒé¢è¡¨ç¤º / å¤–éƒ¨è¡¨ç¤ºï¼‰ | apps/modeler/ssot/preview_out.html<br>apps/modeler/ssot/previewOutBoot.js<br>apps/modeler/ssot/ui/attachUiShell.js (openPreviewOut / focus-mode) | PARTIAL |

## 2ç« 

| ä»•æ§˜ç¯€ | è¦ç‚¹ | å®Ÿè£…å‚ç…§ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«/é–¢æ•°ï¼‰ | çŠ¶æ³ |
|---|---|---|---|
| 2.1 | modeler ãŒæ‰±ã†å…¥åŠ›å½¢å¼ | apps/modeler/ssot/runtime/core/coreControllers.js:file.openFromFilePicker / file.openFromUrl<br>apps/modeler/ssot/runtime/core/coreControllers.js:importNormalize | DONE |
| 2.2 | Save / Exportï¼ˆstrictï¼‰ã®è¦å‰‡ | apps/modeler/ssot/runtime/core/coreControllers.js:validator.validateStrict<br>apps/modeler/ssot/runtime/core/coreControllers.js:file.saveToHandle / file.exportToDisk | DONE |
| 2.3 | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ¡ã‚¿ï¼ˆdocument_metaï¼‰ | apps/modeler/ssot/runtime/core/coreControllers.js:document.getMeta / setMeta<br>apps/modeler/ssot/runtime/core/coreControllers.js:createEmptyDocument | PARTIAL |
| 2.4 | è¦ç´ ã®è­˜åˆ¥ï¼ˆuuid / nameï¼‰ | apps/modeler/ssot/runtime/core/coreControllers.js:uuidOf / nameOf / resolveEndpoint<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js (uuid/kind index) | DONE |
| 2.5 | pointsï¼ˆå­˜åœ¨è¦ç´ ï¼‰ | apps/modeler/ssot/ui/controllers/uiOutlinerController.js:addPoint/deleteSelection<br>apps/modeler/ssot/ui/controllers/uiPropertyController.js (points: position/marker.text)<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js (points render/pick) | PARTIAL |
| 2.6 | linesï¼ˆé–¢ä¿‚è¦ç´ ï¼‰ | apps/modeler/ssot/ui/controllers/uiOutlinerController.js:addLine<br>apps/modeler/ssot/ui/controllers/uiPropertyController.js (lines: endpoints/caption)<br>apps/modeler/ssot/runtime/core/coreControllers.js:resolveEndpoint<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js (lines render/pick) | PARTIAL |
| 2.7 | auxï¼ˆè£œåŠ©è¦ç´ ï¼‰ | apps/modeler/ssot/ui/controllers/uiOutlinerController.js:addAux<br>apps/modeler/ssot/ui/controllers/uiPropertyController.js (aux: module/position/marker)<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js (aux placeholder box) | PARTIAL |
| 2.8 | framesï¼ˆæ™‚é–“å±¤ï¼‰ç·¨é›† | apps/modeler/ssot/ui/controllers/uiToolbarController.js (frame slider/play)<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js:setFrameIndex / applyVisibility<br>apps/modeler/ssot/runtime/modelerHub.js:setFrameIndex | PARTIAL |
| 2.9 | text_poseï¼ˆfront/upï¼‰ã®è§£é‡ˆï¼ˆmodeler å´ï¼‰ | apps/modeler/ssot/runtime/renderer/modelerRenderer.js:normalizeTextPose / axisTokenToVec3<br>apps/modeler/ssot/runtime/core/coreControllers.js:importNormalize (poseæ­£è¦åŒ–ã¯rendererå´) | PARTIAL |

## 3ç« 

| ä»•æ§˜ç¯€ | è¦ç‚¹ | å®Ÿè£…å‚ç…§ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«/é–¢æ•°ï¼‰ | çŠ¶æ³ |
|---|---|---|---|
| 3.1 | ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆPCå‰æï¼‰ | apps/modeler/ssot/index.html (layout)<br>apps/modeler/ssot/modeler.css<br>apps/modeler/ssot/ui/attachUiShell.js (split, focus-mode) | PARTIAL |
| 3.2 | Outlinerï¼ˆpoints / lines / aux / framesï¼‰ | apps/modeler/ssot/ui/controllers/uiOutlinerController.js<br>apps/modeler/ssot/ui/controllers/uiSelectionController.js | PARTIAL |
| 3.3 | PropertyPanelï¼ˆå…±é€š/ç¨®åˆ¥åˆ¥ï¼‰ | apps/modeler/ssot/ui/controllers/uiPropertyController.js | PARTIAL |
| 3.4 | é¸æŠï¼ˆå˜ä½“/è¤‡æ•°/ç¯„å›²ï¼‰ã¨ãƒ•ã‚£ãƒ«ã‚¿ | apps/modeler/ssot/ui/controllers/uiSelectionController.js (multi)<br>apps/modeler/ssot/runtime/core/coreControllers.js:selection controller | PARTIAL |
| 3.5 | å¤‰å½¢ï¼ˆMove/Rotate/Scaleï¼‰ã¨æ•°å€¤å…¥åŠ› | â€” (æ•°å€¤å…¥åŠ›/ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç·¨é›†ã¯ä¸€éƒ¨å¯¾å¿œ; gizmoå¤‰å½¢ã¯æœªå®Ÿè£…) | TODO |
| 3.6 | ã‚¹ãƒŠãƒƒãƒ—ï¼ˆOSNAP / ã‚°ãƒªãƒƒãƒ‰ / è»¸ãƒ­ãƒƒã‚¯ï¼‰ | â€” (snapæœªå®Ÿè£…) | TODO |
| 3.7 | Undo/Redo ã¨ã‚³ãƒãƒ³ãƒ‰å±¥æ­´ UI | apps/modeler/ssot/runtime/core/coreControllers.js:edit (undo/redo)<br>apps/modeler/ssot/ui/controllers/uiToolbarController.js (undo/redo buttons) | PARTIAL |
| 3.8 | ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼ˆã‚­ãƒ¼ãƒãƒƒãƒ—ï¼‰ | apps/modeler/ssot/ui/controllers/uiShortcutController.js (key bindings: undo/redo, delete, etc.) | PARTIAL |
| 3.9 | lockï¼ˆè¦ç´ ãƒ­ãƒƒã‚¯ï¼‰ã¨èª¤æ“ä½œé˜²æ­¢ | apps/modeler/ssot/runtime/core/coreControllers.js:lock controller<br>apps/modeler/ssot/ui/controllers/uiOutlinerController.js (ğŸ”’ toggle)<br>apps/modeler/ssot/ui/controllers/uiPropertyController.js (lockè¡¨ç¤º) | PARTIAL |
| 3.10 | QuickCheck ãƒ‘ãƒãƒ«ï¼ˆä¿å­˜å¤±æ•—æ™‚ã®å°ç·šï¼‰ | apps/modeler/ssot/runtime/core/coreControllers.js:quickcheck controller<br>apps/modeler/ssot/ui/controllers/uiFileController.js (save failure route)<br>apps/modeler/ssot/ui/controllers/uiToolbarController.js (QuickCheck open) | PARTIAL |
| 3.11 | Transformï¼ˆP0ï¼šMove/Rotate/Scaleï¼‰ã¨ãƒ¢ãƒ¼ãƒ‰é·ç§» | â€” (transform mode state machineæœªå®Ÿè£…) | TODO |

## 4ç« 

| ä»•æ§˜ç¯€ | è¦ç‚¹ | å®Ÿè£…å‚ç…§ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«/é–¢æ•°ï¼‰ | çŠ¶æ³ |
|---|---|---|---|
| 4.1 | ã‚·ãƒ¼ãƒ³æ§‹æˆï¼ˆgrid/axis/selection/gizmoï¼‰ | apps/modeler/ssot/runtime/renderer/modelerRenderer.js (scene init: grid/axis placeholder)<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js (selection highlight) | PARTIAL |
| 4.2 | ãƒ”ãƒƒã‚­ãƒ³ã‚°ï¼ˆraycastï¼‰ã¨å„ªå…ˆé †ä½ | apps/modeler/ssot/runtime/renderer/modelerRenderer.js:pickObjectAt | PARTIAL |
| 4.3 | å¤‰å½¢æ“ä½œï¼ˆMove/Rotate/Scaleï¼‰ã¨ä½œæ¥­å¹³é¢ | â€” (gizmo transformæœªå®Ÿè£…) | TODO |
| 4.4 | ãƒ†ã‚­ã‚¹ãƒˆæç”»ï¼ˆpose / align / sizeï¼‰ | apps/modeler/ssot/runtime/renderer/modelerRenderer.js (text sprites: align/size/pose) | PARTIAL |
| 4.5 | ã‚«ãƒ¡ãƒ©ï¼ˆorbit / fit / resetï¼‰ | apps/modeler/ssot/runtime/renderer/modelerRenderer.js (orbit controls + focusOnUuid) | PARTIAL |
| 4.6 | ãƒ•ãƒ¬ãƒ¼ãƒ å†ç”Ÿãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆframes ã®é©ç”¨ï¼‰ | apps/modeler/ssot/ui/controllers/uiToolbarController.js (play)<br>apps/modeler/ssot/runtime/modelerHub.js:setFrameIndex | PARTIAL |

## 5ç« 

| ä»•æ§˜ç¯€ | è¦ç‚¹ | å®Ÿè£…å‚ç…§ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«/é–¢æ•°ï¼‰ | çŠ¶æ³ |
|---|---|---|---|
| 5.1 | çŠ¶æ…‹æ©Ÿæ¢°ï¼ˆmodeï¼‰ | â€” (æ˜ç¤º mode state machineæœªå®Ÿè£…; focus-mode ã¯ ui/attachUiShell.js) | TODO |
| 5.2 | å…¥åŠ›ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆmouse/touch/keyboardï¼‰ | apps/modeler/ssot/ui/controllers/uiCanvasController.js (mouse events)<br>apps/modeler/ssot/ui/controllers/uiShortcutController.js (keyboard) | PARTIAL |
| 5.3 | single-writer ã¨ã‚³ãƒãƒ³ãƒ‰å¢ƒç•Œ | apps/modeler/ssot/scripts/check-single-writer.mjs<br>apps/modeler/ssot/runtime/core/coreControllers.js:edit.applyGroup | PARTIAL |
| 5.4 | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç·¨é›†æ™‚ã®å³æ™‚è¨ºæ–­ï¼‰ | apps/modeler/ssot/runtime/core/coreControllers.js:validator.validateStrict<br>apps/modeler/ssot/ui/controllers/uiPropertyController.js (applyå‰ validation via QuickCheck) | PARTIAL |
| 5.5 | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼ˆå¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿æ™‚ï¼‰ | apps/modeler/ssot/runtime/renderer/modelerRenderer.js (basic perf choices; no perfHud)<br>apps/modeler/ssot/ui/controllers/uiToolbarController.js (DPR toggle?) | TODO |

## 6ç« 

| ä»•æ§˜ç¯€ | è¦ç‚¹ | å®Ÿè£…å‚ç…§ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«/é–¢æ•°ï¼‰ | çŠ¶æ³ |
|---|---|---|---|
| 6.1 | ãƒ­ã‚°ã‚«ãƒ†ã‚´ãƒªï¼ˆBOOT/DOC/EDIT/VALIDATE/IOï¼‰ | apps/modeler/ssot/runtime/core/coreControllers.js (console logs)<br>apps/modeler/ssot/ui/controllers/* (log points)<br>apps/modeler/ssot/runtime/bootstrapModeler.js | PARTIAL |
| 6.2 | Quick Check ã®å‡ºåŠ›ã¨ UI è¡¨ç¤º | apps/modeler/ssot/runtime/core/coreControllers.js:quickcheck.getIssues<br>apps/modeler/ssot/ui/controllers/uiFileController.js (quickcheck panel) | PARTIAL |
| 6.3 | ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆä¾‹å¤–ç¦æ­¢ã¨ no-opï¼‰ | apps/modeler/ssot/runtime/core/coreControllers.js (try/catch around IO)<br>apps/modeler/ssot/runtime/renderer/modelerRenderer.js (defensive checks) | PARTIAL |
| 6.4 | å¤–éƒ¨é€£æºï¼ˆç¦æ­¢ï¼šè¿½è·¡/è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰ | apps/modeler/ssot/manifest.yaml:dependency_rules.forbidden | DONE |

## 7ç« 

| ä»•æ§˜ç¯€ | è¦ç‚¹ | å®Ÿè£…å‚ç…§ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«/é–¢æ•°ï¼‰ | çŠ¶æ³ |
|---|---|---|---|
| 7.1 | schema_uri ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½å¾“ | packages/schemas/3DSS.schema.json + apps/site sync:schemas<br>apps/modeler/ssot/runtime/core/validation.js (schema loading) | PARTIAL |
| 7.2 | sidecar ã®äº’æ›æ€§æ–¹é‡ï¼ˆmodeler å†…é™å®šï¼‰ | apps/modeler/ssot/ui/attachUiShell.js (uiSidecar)<br>apps/modeler/ssot/runtime/core/coreControllers.js:uiSidecar | PARTIAL |
| 7.3 | å°†æ¥æ‹¡å¼µï¼ˆconstraints / blocks / collaborationï¼‰ | â€” (æœªå®Ÿè£…) | TODO |