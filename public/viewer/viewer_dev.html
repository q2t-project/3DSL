<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>3DSL Viewer â€“ Dev Harness</title>
  <style>
    * {
      box-sizing: border-box;
    }

    /* =========================================================
    *  å…¨ä½“ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
    * ======================================================= */
    #viewer-layout {
      display: grid;
      grid-template-columns: minmax(0, 1fr) 300px 240px; /* å·¦=3Dãƒ“ãƒ¥ãƒ¼, å³=ãƒ¡ã‚¿ã‚¨ãƒªã‚¢ */
      height: 100vh; /* ç”»é¢ã®é«˜ã•ã«å›ºå®š */
    }

    html,
    body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    body {
      background: #000;
      color: #ddd;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      overflow: hidden; /* ãƒšãƒ¼ã‚¸å…¨ä½“ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å°ã˜ã‚‹ */
    }

    #viewer-main {
      position: relative;
      background: #111;
      overflow: hidden;
      touch-action: none; /* ã‚¿ãƒƒãƒï¼ãƒˆãƒ©ãƒƒã‚¯ãƒ‘ãƒƒãƒ‰ã§ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æŠ‘æ­¢ */
      height: 100%; /* ã‚°ãƒªãƒƒãƒ‰è¡Œã„ã£ã±ã„ã«ä¼¸ã°ã™ */
    }

    #viewer-canvas {
      width: 100%;
      height: 100%;
      display: block;
      background: #111;
      touch-action: none;
    }

/*
/* åºƒå‘Šæ 
/*
     /* å·¦ä¸Š 300x250 åºƒå‘Šæ ï¼ˆã‚·ãƒ¼ãƒ³ä¸Šã«ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ï¼‰ */
      #ad-top-left {
        position: absolute;
        top: 8px;
        left: 8px;
        width: 300px;
        height: 250px;
        z-index: 20; /* HUD/gizmo ã¨ã®å‰å¾Œã¯å¾Œã§èª¿æ•´ */

        /* ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ç”¨ï¼ˆæœ¬ç•ªã§ã¯ã‚¿ã‚°ã«ç½®ãæ›ãˆï¼‰ */
        box-sizing: border-box;
        border: 1px solid rgba(255, 255, 255, 0.25);
        background: rgba(255, 255, 255, 0.04);
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none; /* ã„ã£ãŸã‚“3Dæ“ä½œå„ªå…ˆã«ã™ã‚‹ãªã‚‰ */
      }

      /* ä¸­å¤®ã® 300x600 ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ‘ãƒ¼æ  */
      #viewer-ad-rail {
        box-sizing: border-box;
        display: flex;
        align-items: center;
        justify-content: center;

        /* ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        border-left: 1px solid #222;
        border-right: 1px solid #222;
        background: rgba(255, 255, 255, 0.02);
        font-size: 12px;
      }

    /* =========================================================
    *  å³å´ãƒ¡ã‚¿æƒ…å ±ã‚¨ãƒªã‚¢
    * ======================================================= */
    #viewer-meta {
      background: #050505;
      border-left: 1px solid rgba(255, 255, 255, 0.12);
      display: flex;
      flex-direction: column;
      font-size: 11px;
      min-width: 220px;
      max-width: 260px;
    }

    #meta-header {
      flex: 0 0 auto;
      padding: 8px 10px 4px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);

      display: flex;
      align-items: flex-end;
      justify-content: flex-start; /* å·¦å¯„ã› */
    }

    #meta-logo-link {
      display: inline-block;
    }

    #meta-logo {
      display: block;
      max-width: 100%;   /* åˆ—å¹…ã«åã¾ã‚‹ã‚ˆã†ã« */
      height: auto;      /* ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ç¶­æŒ */
      filter: invert(1);
    }

    #meta-file,
    #meta-model {
      padding: 4px 2px 8px;
      overflow-y: auto;
    }

    #meta-file {
      flex: 0 0 40%;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    #meta-model {
      flex: 1 1 auto;
    }

    /* viewer_dev.css ç­‰ */

    .detail-panel {
      font-size: 11px;
      line-height: 1.4;
      color: #ddd;
    }

    .detail-header {
      display: flex;
      flex-direction: column;
      gap: 2px;
      margin-bottom: 4px;
      border-bottom: 1px solid #444;
      padding-bottom: 4px;
    }

    .detail-kind {
      font-weight: 600;
      opacity: 0.7;
    }

    .detail-name {
      font-weight: 600;
    }

    .detail-body {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .detail-section {
      margin-bottom: 4px;
    }

    .detail-summary .detail-row {
      display: grid;
      grid-template-columns: minmax(0, 90px) minmax(0, 1fr);
      gap: 2px 6px;
      margin-bottom: 2px;
    }

    .detail-key {
      opacity: 0.7;
      white-space: nowrap;
    }

    .detail-value {
      word-break: break-all;
    }

    .detail-json {
      background: #050505;
      border: 1px solid #333;
      padding: 4px;
      max-height: 260px;
      overflow: auto;
      font-family: "SF Mono", Menlo, Consolas, monospace;
      font-size: 10px;
    }

    #viewer-meta h3 {
      margin: 0 0 4px 0;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.03em;
      text-transform: uppercase;
      opacity: 0.9;
    }

    #viewer-meta pre {
      margin: 4px 0 0 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
      font-size: 10px;
    }

    /* =========================================================
    *  HUDï¼ˆãƒˆãƒ¼ã‚¹ãƒˆï¼‰
    * ======================================================= */
    #viewer-hud {
      position: absolute;
      top: 16px;
      left: 50%;
      transform: translateX(-50%) translateY(-8px);
      max-width: 60%;
      padding: 8px 14px;
      background: rgba(0, 0, 0, 0.85);
      color: #eee;
      font-size: 12px;
      line-height: 1.4;
      border-radius: 999px;
      pointer-events: none;
      opacity: 0;
      transform-origin: top center;
      transition:
        opacity 0.25s ease-out,
        transform 0.25s ease-out;
    }

    #viewer-hud.hud-visible {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    #viewer-hud.hud-hidden {
      opacity: 0;
      transform: translateX(-50%) translateY(-8px);
    }

    #viewer-hud.hud-info {
      background: rgba(0, 0, 0, 0.85);
    }

    #viewer-hud.hud-warn {
      background: rgba(190, 140, 32, 0.9);
    }

    #viewer-hud.hud-error {
      background: rgba(180, 32, 32, 0.9);
    }

    /* =========================================================
    *  ä¸‹éƒ¨ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ï¼ˆframe / å†ç”Ÿ / filterï¼‰
    * ======================================================= */
    #viewer-toolbar {
      position: absolute;
      left: 12px;
      bottom: 12px;
      padding: 8px 12px;
      background: rgba(0, 0, 0, 0.7);
      color: #eee;
      font-size: 11px;
      border-radius: 4px;
      pointer-events: auto;
      display: inline-flex;
      align-items: flex-start;
      gap: 12px;
    }

    .toolbar-main {
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }

    .frame-block {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }


    /* frame-block ã®ä¸­ã‚’å·¦å³ã«å‰²ã‚‹ */
    .frame-row {
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    /* frame-main ã¯ç¸¦ç©ã¿ï¼šä¸ŠãŒãƒ˜ãƒƒãƒ€ã€ä¸‹ãŒã‚¹ãƒ©ã‚¤ãƒ€ */
    .frame-main {
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-width: 220px;
    }

    /* ä¸Šæ®µï¼šå·¦ã« filterã€å³ã«ãƒ©ãƒ™ãƒ«ï¼‹ãƒœã‚¿ãƒ³ */
    .frame-top-row {
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    /* å³å´ãƒ˜ãƒƒãƒ€ï¼ˆãƒ©ãƒ™ãƒ«ï¼‹å†ç”Ÿãƒœã‚¿ãƒ³ç¾¤ï¼‰ */
    .frame-header-main {
      display: flex;
      flex-direction: column;
      gap: 4px;
      flex: 1 1 auto;
    }

    /* è¤‡æ•°ãƒ•ãƒ¬ãƒ¼ãƒ ãªã— â†’ å…¨ä½“ã‚’ã†ã£ã™ã‚‰ã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆï¼ˆJS ã‹ã‚‰ .frame-single ãŒä»˜ãæƒ³å®šï¼‰ */
    .frame-block.frame-single {
      opacity: 0.35;
    }

    /* =========================================================
    *  filter ãƒˆã‚°ãƒ«ï¼ˆå·¦ä¸Šç¸¦ç©ã¿ï¼‰
    * ======================================================= */
    .filter-column {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-top: 0;
    }

    .filter-toggle {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 2px 6px;
      border-radius: 3px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.02);
      color: #eee;
      cursor: pointer;
    }

    .filter-toggle .icon {
      font-size: 13px;
    }

    .filter-toggle.filter-off {
      opacity: 0.3;
    }

    /* =========================================================
    *  frame ãƒœã‚¿ãƒ³ç¾¤ï¼ˆå³ä¸Šï¼‰
    * ======================================================= */
    #frame-controls {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    #frame-controls .row {
      display: flex;
      gap: 4px;
    }

    #frame-controls .row-continuous,
    #frame-controls .row-flip {
      opacity: 0.4;
      transition: opacity 0.15s ease-out;
    }

    #frame-controls.mode-continuous .row-continuous,
    #frame-controls.mode-flip .row-flip {
      opacity: 1;
    }

    /* =========================================================
    *  frame ã‚¹ãƒ©ã‚¤ãƒ€ï¼ˆã‚¼ãƒ­åŸºæº–ã‚²ãƒ¼ã‚¸ / ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ï¼‰
    * ======================================================= */

    #frame-slider {
      width: 8vw;
      min-width: 160px;
      max-width: 260px;

      --frame-zero-frac: 0.5;        /* 0 ãŒãƒ¬ãƒ³ã‚¸å†…ã®ã©ã“ã‹ï¼ˆ0.0ã€œ1.0ï¼‰ */
      --frame-track-height: 4px;
      --frame-zero-width: 2px;

      -webkit-appearance: none;
      appearance: none;
      height: var(--frame-track-height);
      border-radius: 999px;
      background: transparent;
    }

    /* WebKit */
    #frame-slider::-webkit-slider-runnable-track {
      height: var(--frame-track-height);
      border-radius: 999px;
      background: #444;
    }

    #frame-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #ffffff;
      border: 1px solid rgba(0, 0, 0, 0.6);
      margin-top: calc(-0.5 * var(--frame-track-height));
      box-shadow: 0 0 4px rgba(0, 0, 0, 0.8);
      cursor: pointer;
    }

    /* Firefox */
    #frame-slider::-moz-range-track {
      height: var(--frame-track-height);
      border-radius: 999px;
      background: #444;
    }

    #frame-slider::-moz-range-thumb {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #ffffff;
      border: 1px solid rgba(0, 0, 0, 0.6);
      box-shadow: 0 0 4px rgba(0, 0, 0, 0.8);
      cursor: pointer;
    }

    /* gauge ãƒ¢ãƒ¼ãƒ‰ï¼šä¸­å¤® 0 ã®åŸºæº–ç·šã‚’å¼·èª¿ */
    #frame-slider.frame-mode-gauge::-webkit-slider-runnable-track {
      background:
        linear-gradient(#ffffff, #ffffff) no-repeat,
        linear-gradient(#444444, #444444);
      background-size:
        var(--frame-zero-width) 100%,
        100% 100%;
      background-position:
        calc(var(--frame-zero-frac) * 100%) 0,
        0 0;
    }

    #frame-slider.frame-mode-gauge::-moz-range-track {
      background:
        linear-gradient(#ffffff, #ffffff) no-repeat,
        linear-gradient(#444444, #444444);
      background-size:
        var(--frame-zero-width) 100%,
        100% 100%;
      background-position:
        calc(var(--frame-zero-frac) * 100%) 0,
        0 0;
    }

    /* timeline ãƒ¢ãƒ¼ãƒ‰ï¼šå·¦â†’å³ã®å‹•ç”»ãƒãƒ¼é¢¨ */
    #frame-slider.frame-mode-timeline::-webkit-slider-runnable-track {
      background: linear-gradient(
        to right,
        rgba(255, 255, 255, 0.55),
        rgba(255, 255, 255, 0.12)
      );
    }

    #frame-slider.frame-mode-timeline::-moz-range-track {
      background: linear-gradient(
        to right,
        rgba(255, 255, 255, 0.55),
        rgba(255, 255, 255, 0.12)
      );
    }

    /* =========================================================
    *  å…±é€šãƒœã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«
    * ======================================================= */
    #viewer-toolbar button {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 3px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      background: rgba(255, 255, 255, 0.04);
      color: #eee;
      cursor: pointer;
    }

    #viewer-toolbar button:hover {
      background: rgba(255, 255, 255, 0.12);
    }

    .keycap {
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.8);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.04);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
    }

    .keycap:hover {
      background: rgba(255, 255, 255, 0.18);
    }

    /* =========================================================
    *  ã‚«ãƒ¡ãƒ©ãƒ¢ãƒ¼ãƒ‰è¡¨ç¤ºï¼ˆå³ä¸‹ï¼‰
    * ======================================================= */
    #camera-panel {
      position: absolute;
      right: 12px;
      bottom: 232px; /* gizmo(210px) + ãƒãƒ¼ã‚¸ãƒ³ 12px + å°‘ã—ä½™ç™½ */
      display: flex;
      align-items: flex-end;
      pointer-events: none; /* å­è¦ç´ ã§åˆ¶å¾¡ */
    }

    #mode-stack {
      position: relative;
      display: flex;
      flex-direction: column;
      padding-bottom: 0;
    }

    .mode-pills-block {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .mode-pill {
      min-width: 60px;
      padding: 2px 6px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.25);
      background: transparent;
      text-align: center;
      font-size: 9px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      opacity: 0.5;
      transition:
        opacity 0.15s ease-out,
        background-color 0.15s ease-out,
        color 0.15s ease-out;
    }

    .mode-pill-active {
      background: rgba(255, 255, 255, 0.85);
      color: #000000;
      opacity: 1;
    }

    /* =========================================================
    *  Gizmo æœ¬ä½“
    * ======================================================= */
    /* gizmo ã‚³ãƒ³ãƒ†ãƒŠï¼šã‚·ãƒ¼ãƒ³ã‚«ãƒ©ãƒ ã®å³ä¸‹ã«å¯„ã›ã‚‹ */
    #viewer-gizmo {
      position: absolute;
      right: 24px;   /* â† ã“ã“ãŒã€Œã‚·ãƒ¼ãƒ³ã®å³ç«¯ã‹ã‚‰ã®è·é›¢ã€ã«ãªã‚‹ */
      bottom: 24px;
      pointer-events: auto;
    }

    #gizmo-wrapper {
      position: absolute;
      right: 12px;
      bottom: 64px;   /* 12px â†’ 64pxï¼šå…¨ä½“ã‚’å°‘ã—ä¸Šã¸ */
      width: 210px;
      height: 210px;
      pointer-events: auto;
      z-index: 20;
    }

    #gizmo-slot {
      position: absolute;
      inset: 0;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.5);
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.6);
      overflow: hidden;
    }

    #gizmo-slot canvas {
      width: 100%;
      height: 100%;
      display: block;
    }

    /* HOME ãƒœã‚¿ãƒ³ï¼ˆå·¦ä¸Šï¼‰ */
    #gizmo-home {
      position: absolute;
      left: 4px;
      top: 4px;
      padding: 1px 8px;
      font-size: 9px;
      line-height: 1.4;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.8);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.04);
      cursor: pointer;
    }

    #gizmo-home:hover {
      background: rgba(255, 255, 255, 0.18);
    }

    /* X/Y/Z è¡Œï¼ˆå³ä¸‹ã«çµ¶å¯¾é…ç½®ï¼‰ */
    .gizmo-axis-row {
      position: absolute;
      right: 4px;
      bottom: 4px;
      display: flex;
      gap: 4px;
    }

    .gizmo-axis {
      width: 22px;
      height: 22px;
      font-size: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.8);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.04);
      cursor: pointer;
    }

    .gizmo-axis:hover {
      background: rgba(255, 255, 255, 0.18);
    }

    #gizmo-slot svg {
      pointer-events: none;
    }

    #gizmo-wrapper button,
    #gizmo-wrapper .keycap,
    #gizmo-wrapper .gizmo-axis {
      pointer-events: auto;
      position: relative;
      z-index: 30;
    }

    /* preset view ãƒˆã‚°ãƒ«ï¼ˆå³ä¸‹ row å†…ã® pillï¼‰ */
    #gizmo-presets-toggle {
      padding: 2px 10px;
      font-size: 10px;
      line-height: 1.4;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.8);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.04);
      cursor: pointer;
    }

    #gizmo-presets-toggle:hover {
      background: rgba(255, 255, 255, 0.18);
    }

    /* =========================================================
    *  åº§æ¨™è»¸ãƒˆã‚°ãƒ« + AutoOrbit + preset viewï¼ˆå³ä¸‹ä¸€åˆ—ï¼‰
    * ======================================================= */
    #camera-bottom-row {
      position: absolute;
      right: 16px;
      bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      z-index: 25;
      pointer-events: auto;
    }

    #camera-panel {
      position: absolute;
      right: 12px;
      bottom: 286px; /* 232px â†’ 286px = (64 + 210 + 12) */
      display: flex;
      align-items: flex-end;
      pointer-events: none;
    }

    .world-axes-toggle {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      color: #ccc;
    }

    .world-axes-label {
      opacity: 0.8;
    }

    #world-axes-toggle {
      border: none;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.04);
      color: inherit;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 2px;
    }

    #world-axes-toggle[data-visible="true"] {
      background: rgba(255, 255, 255, 0.12);
    }

    #world-axes-toggle .icon {
      font-size: 14px;
    }

    #world-axes-toggle[data-visible="true"] [data-icon="off"],
    #world-axes-toggle[data-visible="false"] [data-icon="on"] {
      display: none;
    }

    /* AutoOrbit ã‚¹ãƒ­ãƒƒãƒˆæœ¬ä½“ï¼šå¸¸ã«åŒã˜æ ã‚µã‚¤ã‚º */
    .auto-orbit-slot {
      position: relative;
      flex: 0 0 auto;
      width: 130px; /* 3ãƒœã‚¿ãƒ³åˆ†ã®å›ºå®šå¹… */
      height: 24px;
    }

    .auto-orbit-pill,
    .auto-orbit-controls {
      position: absolute;
      inset: 0;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .auto-orbit-pill {
      font-size: 10px;
      padding: 2px 10px;
    }

    .auto-orbit-controls {
      gap: 4px;
    }

    .auto-orbit-btn {
      min-width: 26px;
      padding: 1px 0;
      font-size: 11px;
    }

    .auto-orbit-slot[data-mode="collapsed"] .auto-orbit-controls {
      opacity: 0;
      pointer-events: none;
    }

    .auto-orbit-slot[data-mode="collapsed"] .auto-orbit-pill {
      opacity: 1;
      pointer-events: auto;
    }

    .auto-orbit-slot[data-mode="expanded"] .auto-orbit-controls {
      opacity: 1;
      pointer-events: auto;
    }

    .auto-orbit-slot[data-mode="expanded"] .auto-orbit-pill {
      opacity: 0;
      pointer-events: none;
    }

    .auto-orbit-pill,
    .auto-orbit-controls {
      transition: opacity 0.15s ease-out;
    }

    /* =========================================================
    *  viewerSettings ç°¡æ˜“ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
    * ======================================================= */
    .viewer-settings-block {
      margin-top: 4px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .viewer-settings-row {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .viewer-settings-label {
      opacity: 0.8;
      font-size: 10px;
      white-space: nowrap;
    }

    .viewer-settings-row select {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 3px;
      border: 1px solid rgba(255, 255, 255, 0.25);
      background: rgba(0, 0, 0, 0.8);
      color: #eee;
    }


    /* =========================================================
    *  2D preset overlayï¼ˆä»Šã¯åŸºæœ¬ã‚ªãƒ•ã€‚æ®‹ã—ã¦ãŠãã ã‘ï¼‰
    * ======================================================= */
    #view-presets-overlay {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 25;
      opacity: 0;
      transition: opacity 0.15s ease-out;
    }

    #view-presets-overlay[data-open="true"] {
      pointer-events: auto;
      opacity: 1;
    }

    .view-preset {
      position: absolute;
      width: 26px;
      height: 26px;
      border-radius: 4px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      background: radial-gradient(
        circle at 20% 20%,
        rgba(255, 255, 255, 0.3),
        rgba(0, 0, 0, 0.95)
      );
      box-shadow: 0 0 4px rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      padding: 0;
      outline: none;
    }

    .view-preset::before {
      content: "";
      position: absolute;
      inset: 4px;
      border-radius: 3px;
      border: 1px solid rgba(255, 255, 255, 0.8);
    }

    .view-preset::after {
      content: "";
      position: absolute;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      border: 1px solid rgba(220, 235, 255, 0.9);
      background: radial-gradient(
        circle,
        #ffffff,
        #88aaff 60%,
        rgba(0, 0, 0, 0)
      );
      box-shadow: 0 0 4px rgba(160, 200, 255, 0.9);
    }

    .view-preset:hover {
      border-color: rgba(255, 255, 255, 0.9);
      box-shadow: 0 0 6px rgba(200, 230, 255, 0.9);
    }

    .view-preset[data-active="true"] {
      border-color: rgba(200, 220, 255, 1);
      box-shadow: 0 0 8px rgba(170, 210, 255, 1);
    }

    .view-preset-beam {
      position: absolute;
      width: 2px;
      height: 22px;
      background: linear-gradient(
        to bottom,
        rgba(150, 190, 255, 0),
        rgba(190, 220, 255, 0.6),
        rgba(255, 255, 255, 1)
      );
      transform-origin: top center;
      opacity: 0;
      pointer-events: none;
    }

    @keyframes presetBeamPulse {
      0% {
        opacity: 0.05;
      }
      50% {
        opacity: 1;
      }
      100% {
        opacity: 0.05;
      }
    }

    .view-preset[data-active="true"] .view-preset-beam {
      animation: presetBeamPulse 1.2s ease-out infinite;
    }

    /* ãƒ“ãƒ¼ãƒ ã®å‘ããƒ»ä½ç½® */
    .view-preset[data-pos="top"] .view-preset-beam {
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
    }

    .view-preset[data-pos="bottom"] .view-preset-beam {
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%) rotate(180deg);
    }

    .view-preset[data-pos="left"] .view-preset-beam {
      left: 100%;
      top: 50%;
      transform: translateY(-50%) rotate(90deg);
    }

    .view-preset[data-pos="right"] .view-preset-beam {
      right: 100%;
      top: 50%;
      transform: translateY(-50%) rotate(-90deg);
    }

    .view-preset[data-pos="ne"] .view-preset-beam {
      top: 88%;
      right: 88%;
      transform: translate(50%, -50%) rotate(-135deg);
    }

    .view-preset[data-pos="nw"] .view-preset-beam {
      top: 88%;
      left: 88%;
      transform: translate(-50%, -50%) rotate(-45deg);
    }

    .view-preset[data-pos="se"] .view-preset-beam {
      bottom: 88%;
      right: 88%;
      transform: translate(50%, 50%) rotate(135deg);
    }

    .view-preset[data-pos="sw"] .view-preset-beam {
      bottom: 88%;
      left: 88%;
      transform: translate(-50%, 50%) rotate(45deg);
    }

    /* ã‚®ã‚ºãƒ¢ã¾ã‚ã‚Šã«é…ç½®ã™ã‚‹ãƒã‚¸ã‚·ãƒ§ãƒ³ */
    .view-preset[data-pos="top"] {
      top: 2px;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .view-preset[data-pos="bottom"] {
      bottom: 2px;
      left: 50%;
      transform: translate(-50%, 50%);
    }

    .view-preset[data-pos="left"] {
      left: 2px;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    .view-preset[data-pos="right"] {
      right: 2px;
      top: 50%;
      transform: translate(50%, -50%);
    }

    .view-preset[data-pos="ne"] {
      top: 6px;
      right: 6px;
      transform: translate(0, -50%);
    }

    .view-preset[data-pos="nw"] {
      top: 6px;
      left: 6px;
      transform: translate(0, -50%);
    }

    .view-preset[data-pos="se"] {
      bottom: 6px;
      right: 6px;
      transform: translate(0, 50%);
    }

    .view-preset[data-pos="sw"] {
      bottom: 6px;
      left: 6px;
      transform: translate(0, 50%);
    }
  </style>

  </head>

<body>
  <div id="viewer-layout">
    <!-- å·¦ï¼š3D ãƒ“ãƒ¥ãƒ¼ï¼‹ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å…¨éƒ¨ -->
    <div id="viewer-main">
      <!-- å·¦ä¸Š 300x250 -->
      <div id="ad-top-left">300Ã—250 AD</div>

      <!-- 3D ã‚·ãƒ¼ãƒ³ -->
      <canvas id="viewer-canvas"></canvas>

      <!-- HUD: ä¸€æ™‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”¨ãƒˆãƒ¼ã‚¹ãƒˆ -->
      <div id="viewer-hud" class="hud-hidden"></div>

      <!-- ä¸‹éƒ¨ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
      <div id="viewer-toolbar">
        <div class="frame-block">
          <div class="frame-main">
            <div class="frame-top-row">
              <div class="filter-column">
                <button
                  id="filter-lines"
                  class="filter-toggle filter-on"
                  type="button"
                  title="toggle lines"
                >
                  <span class="icon">ğŸ‘</span><span class="label">lines</span>
                </button>
                <button
                  id="filter-points"
                  class="filter-toggle filter-on"
                  type="button"
                  title="toggle points"
                >
                  <span class="icon">ğŸ‘</span><span class="label">points</span>
                </button>
                <button
                  id="filter-aux"
                  class="filter-toggle filter-on"
                  type="button"
                  title="toggle aux"
                >
                  <span class="icon">ğŸ‘</span><span class="label">aux</span>
                </button>
              </div>

              <div class="frame-header-main">
                <div class="frame-label">
                  Frame: <span id="frame-slider-label">0</span>
                </div>

                <div id="frame-controls" class="mode-flip">
                  <div class="row row-continuous">
                    <button id="btn-rew" title="é€†é€ã‚Šï¼ˆæœ€å°ã¾ã§ã‚¸ãƒ£ãƒ³ãƒ—ï¼‰">
                      â®
                    </button>
                    <button id="btn-play" title="å†ç”Ÿ / ä¸€æ™‚åœæ­¢ (Space)">
                      Play
                    </button>
                    <button id="btn-ff" title="å…ˆé€ã‚Šï¼ˆæœ€å¤§ã¾ã§ã‚¸ãƒ£ãƒ³ãƒ—ï¼‰">
                      â­
                    </button>
                  </div>
                  <div class="row row-flip">
                    <button id="btn-step-back" title="1 ãƒ•ãƒ¬ãƒ¼ãƒ æˆ»ã‚‹ (PgDn)">
                      â—€
                    </button>
                    <button id="btn-home" title="ãƒ›ãƒ¼ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ  (0)">â—</button>
                    <button
                      id="btn-step-forward"
                      title="1 ãƒ•ãƒ¬ãƒ¼ãƒ é€²ã‚€ (PgUp)"
                    >
                      â–¶
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <input
              id="frame-slider"
              type="range"
              min="0"
              max="0"
              value="0"
              step="1"
            />
             <!-- viewerSettings: line width / microFX profile -->
            <div class="viewer-settings-block">
              <div class="viewer-settings-row">
                <span class="viewer-settings-label">line width</span>
                <select id="vs-linewidth-mode">
                  <option value="auto">auto</option>
                  <option value="fixed">fixed</option>
                  <option value="adaptive">adaptive</option>
                </select>
              </div>
              <div class="viewer-settings-row">
                <span class="viewer-settings-label">micro FX</span>
                <select id="vs-micro-profile">
                  <option value="weak">weak</option>
                  <option value="normal" selected>normal</option>
                  <option value="strong">strong</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ã‚«ãƒ¡ãƒ©ãƒ¢ãƒ¼ãƒ‰è¡¨ç¤ºï¼ˆå³ä¸Šå¯„ã‚Šï¼‰ -->
      <div id="camera-panel">
        <div id="mode-stack">
          <div class="mode-pills-block">
            <div id="mode-label-macro" class="mode-pill mode-pill-active">
              MACRO
            </div>
            <div id="mode-label-micro" class="mode-pill">MICRO</div>
          </div>
        </div>
      </div>

      <!-- Gizmo æœ¬ä½“ï¼ˆå³ä¸‹ï¼‰ -->
      <div id="gizmo-wrapper">
        <div class="gizmo-axis-row"></div>
        <div id="gizmo-slot"></div>
      </div>

      <!-- åº§æ¨™è»¸ãƒˆã‚°ãƒ« + autoOrbit + preset viewï¼ˆå³ä¸‹æ¨ªä¸¦ã³ï¼‰ -->
      <div id="camera-bottom-row">
        <div class="world-axes-toggle">
          <button
            id="world-axes-toggle"
            type="button"
            aria-pressed="false"
            data-visible="false"
          >
            <span class="icon" data-icon="on">ğŸ‘</span>
            <span class="icon" data-icon="off">ğŸ‘â€ğŸ—¨</span>
          </button>
          <span class="world-axes-label">coord.</span>
        </div>

        <div id="auto-orbit-slot" class="auto-orbit-slot">
          <button
            id="auto-orbit-pill"
            type="button"
            class="keycap auto-orbit-pill"
            title="Auto orbit"
          >
            autoOrbit
          </button>

          <div id="auto-orbit-controls" class="auto-orbit-controls">
            <button
              type="button"
              class="keycap auto-orbit-btn"
              data-role="rev"
              title="Reverse orbit / faster reverse"
            >
              âŸ²
            </button>
            <button
              type="button"
              class="keycap auto-orbit-btn"
              data-role="stop"
              title="Stop auto orbit"
            >
              â– 
            </button>
            <button
              type="button"
              class="keycap auto-orbit-btn"
              data-role="fwd"
              title="Forward orbit / faster"
            >
              âŸ³
            </button>
          </div>
        </div>

        <button
          id="gizmo-presets-toggle"
          class="keycap"
          type="button"
          title="Preset views"
        >
          preset view
        </button>
      </div>
    </div> <!-- /viewer-main -->

    <!-- ä¸­å¤®ï¼š300x600 -->
    <aside id="viewer-ad-rail">
      300Ã—600 AD
    </aside>

    <!-- å³ï¼šãƒ¡ã‚¿æƒ…å ±ã‚¨ãƒªã‚¢ -->
    <aside id="viewer-meta">
      <div id="meta-header">
        <a id="meta-logo-link" href="/viewer/">
          <img
            id="meta-logo"
            src="../assets/logo/3DSD-viewer.svg"
            alt="3DSD-viewer"
          />
        </a>
      </div>

      <div id="meta-file">
        <h3>File</h3>
        <div>(no file yet)</div>
      </div>
      <div id="meta-model">
        <h3>Model</h3>
        <div id="meta-model-log" class="meta-log">
          (logs will appear here)
        </div>
        <div id="viewer-detail"></div>
      </div>
    </aside>
  </div>

  <script type="module" src="./viewerDevHarness.js"></script>
</body>
</html>
